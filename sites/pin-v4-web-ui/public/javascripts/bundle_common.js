(function(a){a.fn.extend({autocomplete:function(c,b){var i=typeof c=="string";b=a.extend({},a.Autocompleter.defaults,{url:i?c:null,data:i?null:c,delay:i?a.Autocompleter.defaults.delay:10,max:b&&!b.scroll?10:150},b);b.highlight=b.highlight||function(j){return j};b.formatMatch=b.formatMatch||b.formatItem;return this.each(function(){new a.Autocompleter(this,b)})},result:function(c){return this.bind("result",c)},search:function(c){return this.trigger("search",[c])},flushCache:function(){return this.trigger("flushCache")},
setOptions:function(c){return this.trigger("setOptions",[c])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(c,b){function i(){var f=s.selected();if(!f)return false;var p=f.result;o=p;if(b.multiple){var t=r(d.val());if(t.length>1){var y=b.multipleSeparator.length,A=a(c).selection().start,w,v=0;a.each(t,function(C,B){v+=B.length;if(A<=v){w=C;return false}v+=y});t[w]=p;p=t.join(b.multipleSeparator)}p+=b.multipleSeparator}d.val(p);n();d.trigger("result",[f.data,
f.value]);return true}function j(f,p){if(l==g.DEL)s.hide();else{var t=d.val();if(!(!p&&t==o)){o=t;t=m(t);if(t.length>=b.minChars){d.addClass(b.loadingClass);b.matchCase||(t=t.toLowerCase());k(t,e,n)}else{d.removeClass(b.loadingClass);s.hide()}}}}function r(f){if(!f)return[""];if(!b.multiple)return[a.trim(f)];return a.map(f.split(b.multipleSeparator),function(p){return a.trim(f).length?a.trim(p):null})}function m(f){if(!b.multiple)return f;var p=r(f);if(p.length==1)return p[0];p=a(c).selection().start;
p=p==f.length?r(f):r(f.replace(f.substring(p),""));return p[p.length-1]}function n(){s.visible();s.hide();clearTimeout(h);d.removeClass(b.loadingClass);b.mustMatch&&d.search(function(f){if(!f)if(b.multiple){f=r(d.val()).slice(0,-1);d.val(f.join(b.multipleSeparator)+(f.length?b.multipleSeparator:""))}else{d.val("");d.trigger("result",null)}})}function e(f,p){if(p&&p.length&&q){d.removeClass(b.loadingClass);s.display(p,f);var t=p[0].value;if(b.autoFill&&m(d.val()).toLowerCase()==f.toLowerCase()&&l!=
g.BACKSPACE){d.val(d.val()+t.substring(m(o).length));a(c).selection(o.length,o.length+t.length)}s.show()}else n()}function k(f,p,t){b.matchCase||(f=f.toLowerCase());var y=u.load(f);if(y&&y.length)p(f,y);else if(typeof b.url=="string"&&b.url.length>0){var A={timestamp:+new Date};a.each(b.extraParams,function(w,v){A[w]=typeof v=="function"?v():v});a.ajax({mode:"abort",port:"autocomplete"+c.name,dataType:b.dataType,url:b.url,data:a.extend({q:m(f),limit:b.max},A),success:function(w){var v;if(!(v=b.parse&&
b.parse(w))){v=[];w=w.split("\n");for(var C=0;C<w.length;C++){var B=a.trim(w[C]);if(B){B=B.split("|");v[v.length]={data:B,value:B[0],result:b.formatResult&&b.formatResult(B,B[0])||B[0]}}}v=v}v=v;u.add(f,v);p(f,v)}})}else{s.emptyList();t(f)}}var g={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},d=a(c).attr("autocomplete","off").addClass(b.inputClass),h,o="",u=a.Autocompleter.Cache(b),q=0,l,x={mouseDownOnSelect:false},s=a.Autocompleter.Select(b,c,i,x),z;a.browser.opera&&
a(c.form).bind("submit.autocomplete",function(){if(z)return z=false});d.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(f){q=1;l=f.keyCode;switch(f.keyCode){case g.UP:f.preventDefault();s.visible()?s.prev():j(0,true);break;case g.DOWN:f.preventDefault();s.visible()?s.next():j(0,true);break;case g.PAGEUP:f.preventDefault();s.visible()?s.pageUp():j(0,true);break;case g.PAGEDOWN:f.preventDefault();s.visible()?s.pageDown():j(0,true);break;case b.multiple&&a.trim(b.multipleSeparator)==
","&&g.COMMA:case g.TAB:case g.RETURN:if(i()){f.preventDefault();z=true;return false}break;case g.ESC:s.hide();break;default:clearTimeout(h);h=setTimeout(j,b.delay);break}}).focus(function(){q++}).blur(function(){q=0;if(!x.mouseDownOnSelect){clearTimeout(h);h=setTimeout(n,200)}}).click(function(){q++>1&&!s.visible()&&j(0,true)}).bind("search",function(){function f(t,y){var A;if(y&&y.length)for(var w=0;w<y.length;w++)if(y[w].result.toLowerCase()==t.toLowerCase()){A=y[w];break}typeof p=="function"?
p(A):d.trigger("result",A&&[A.data,A.value])}var p=arguments.length>1?arguments[1]:null;a.each(r(d.val()),function(t,y){k(y,f,f)})}).bind("flushCache",function(){u.flush()}).bind("setOptions",function(f,p){a.extend(b,p);"data"in p&&u.populate()}).bind("unautocomplete",function(){s.unbind();d.unbind();a(c.form).unbind(".autocomplete")}).bind("input",function(){j(0,true)})};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,
matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(c){return c[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(c){function b(e,k){c.matchCase||(e=
e.toLowerCase());var g=e.indexOf(k);if(c.matchContains=="word")g=e.toLowerCase().search("\\b"+k.toLowerCase());if(g==-1)return false;return g==0||c.matchContains}function i(e,k){n>c.cacheLength&&r();m[e]||n++;m[e]=k}function j(){if(!c.data)return false;var e={},k=0;if(!c.url)c.cacheLength=1;e[""]=[];for(var g=0,d=c.data.length;g<d;g++){var h=c.data[g];h=typeof h=="string"?[h]:h;var o=c.formatMatch(h,g+1,c.data.length);if(o!==false){var u=o.charAt(0).toLowerCase();e[u]||(e[u]=[]);h={value:o,data:h,
result:c.formatResult&&c.formatResult(h)||o};e[u].push(h);k++<c.max&&e[""].push(h)}}a.each(e,function(q,l){c.cacheLength++;i(q,l)})}function r(){m={};n=0}var m={},n=0;setTimeout(j,25);return{flush:r,add:i,populate:j,load:function(e){if(!c.cacheLength||!n)return null;if(!c.url&&c.matchContains){var k=[];for(var g in m)if(g.length>0){var d=m[g];a.each(d,function(h,o){b(o.value,e)&&k.push(o)})}return k}else if(m[e])return m[e];else if(c.matchSubset)for(g=e.length-1;g>=c.minChars;g--)if(d=m[e.substr(0,
g)]){k=[];a.each(d,function(h,o){if(b(o.value,e))k[k.length]=o});return k}return null}}};a.Autocompleter.Select=function(c,b,i,j){function r(){if(o){u=a("<div/>").hide().addClass(c.resultsClass).css("position","absolute").appendTo(document.body);q=a("<ul/>").appendTo(u).mouseover(function(l){if(m(l).nodeName&&m(l).nodeName.toUpperCase()=="LI"){g=a("li",q).removeClass(e.ACTIVE).index(m(l));a(m(l)).addClass(e.ACTIVE)}}).click(function(l){a(m(l)).addClass(e.ACTIVE);i();b.focus();return false}).mousedown(function(){j.mouseDownOnSelect=
true}).mouseup(function(){j.mouseDownOnSelect=false});c.width>0&&u.css("width",c.width);o=false}}function m(l){for(l=l.target;l&&l.tagName!="LI";)l=l.parentNode;if(!l)return[];return l}function n(l){k.slice(g,g+1).removeClass(e.ACTIVE);g+=l;if(g<0)g=k.size()-1;else if(g>=k.size())g=0;l=k.slice(g,g+1).addClass(e.ACTIVE);if(c.scroll){var x=0;k.slice(0,g).each(function(){x+=this.offsetHeight});if(x+l[0].offsetHeight-q.scrollTop()>q[0].clientHeight)q.scrollTop(x+l[0].offsetHeight-q.innerHeight());else x<
q.scrollTop()&&q.scrollTop(x)}}var e={ACTIVE:"ac_over"},k,g=-1,d,h="",o=true,u,q;return{display:function(l,x){r();d=l;h=x;q.empty();for(var s=c.max&&c.max<d.length?c.max:d.length,z=0;z<s;z++)if(d[z]){var f=c.formatItem(d[z].data,z+1,s,d[z].value,h);if(f!==false){f=a("<li/>").html(c.highlight(f,h)).addClass(z%2==0?"ac_even":"ac_odd").appendTo(q)[0];a.data(f,"ac_data",d[z])}}k=q.find("li");if(c.selectFirst){k.slice(0,1).addClass(e.ACTIVE);g=0}a.fn.bgiframe&&q.bgiframe()},next:function(){n(1)},prev:function(){n(-1)},
pageUp:function(){g!=0&&g-8<0?n(-g):n(-8)},pageDown:function(){g!=k.size()-1&&g+8>k.size()?n(k.size()-1-g):n(8)},hide:function(){u&&u.hide();k&&k.removeClass(e.ACTIVE);g=-1},visible:function(){return u&&u.is(":visible")},current:function(){return this.visible()&&(k.filter("."+e.ACTIVE)[0]||c.selectFirst&&k[0])},show:function(){var l=a(b).offset();u.css({width:typeof c.width=="string"||c.width>0?c.width:a(b).width(),top:l.top+b.offsetHeight,left:l.left}).show();if(c.scroll){q.scrollTop(0);q.css({maxHeight:c.scrollHeight,
overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var x=0;k.each(function(){x+=this.offsetHeight});l=x>c.scrollHeight;q.css("height",l?c.scrollHeight:x);l||k.width(q.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}},selected:function(){var l=k&&k.filter("."+e.ACTIVE).removeClass(e.ACTIVE);return l&&l.length&&a.data(l[0],"ac_data")},emptyList:function(){q&&q.empty()},unbind:function(){u&&u.remove()}}};a.fn.selection=function(c,b){if(c!==
undefined)return this.each(function(){if(this.createTextRange){var n=this.createTextRange();if(b===undefined||c==b)n.move("character",c);else{n.collapse(true);n.moveStart("character",c);n.moveEnd("character",b)}n.select()}else if(this.setSelectionRange)this.setSelectionRange(c,b);else if(this.selectionStart){this.selectionStart=c;this.selectionEnd=b}});var i=this[0];if(i.createTextRange){var j=document.selection.createRange(),r=i.value,m=j.text.length;j.text="<->";j=i.value.indexOf("<->");i.value=
r;this.selection(j,j+m);return{start:j,end:j+m}}else if(i.selectionStart!==undefined)return{start:i.selectionStart,end:i.selectionEnd}}})(jQuery);jQuery.cookie=function(a,c,b){if(arguments.length>1&&String(c)!=="[object Object]"){b=jQuery.extend({},b);if(c===null||c===undefined)b.expires=-1;if(typeof b.expires==="number"){var i=b.expires,j=b.expires=new Date;j.setDate(j.getDate()+i)}c=String(c);return document.cookie=[encodeURIComponent(a),"=",b.raw?c:encodeURIComponent(c),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join("")}b=c||{};j=b.raw?function(r){return r}:
decodeURIComponent;return(i=RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?j(i[1]):null};(function(a){function c(d){if(a.facebox.settings.inited)return true;else a.facebox.settings.inited=true;a(document).trigger("init.facebox");j();var h=a.facebox.settings.imageTypes.join("|");a.facebox.settings.imageTypesRegexp=RegExp("."+h+"$","i");d&&a.extend(a.facebox.settings,d);a("body").append(a.facebox.settings.faceboxHtml);var o=[new Image,new Image];a("#facebox").find(".b:first, .bl, .br, .tl, .tr").each(function(){o.push(new Image);o.slice(-1).src=a(this).css("background-image").replace(/url\((.+)\)/,
"$1")});a("#facebox .close").click(a.facebox.close)}function b(){var d,h;if(self.pageYOffset){h=self.pageYOffset;d=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){h=document.documentElement.scrollTop;d=document.documentElement.scrollLeft}else if(document.body){h=document.body.scrollTop;d=document.body.scrollLeft}return Array(d,h)}function i(){var d;if(self.innerHeight)d=self.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)d=
document.documentElement.clientHeight;else if(document.body)d=document.body.clientHeight;return d}function j(){var d=a.facebox.settings;d.imageTypes=d.image_types||d.imageTypes;d.faceboxHtml=d.facebox_html||d.faceboxHtml}function r(d,h){if(d.match(/#/)){var o=window.location.href.split("#")[0];o=d.replace(o,"");a.facebox.reveal(a(o).clone().show(),h)}else d.match(a.facebox.settings.imageTypesRegexp)?m(d,h):n(d,h)}function m(d,h){var o=new Image;o.onload=function(){a.facebox.reveal('<div class="image"><img src="'+
o.src+'" /></div>',h)};o.src=d}function n(d,h){a.get(d,function(o){a.facebox.reveal(o,h)})}function e(){return a.facebox.settings.overlay==false||a.facebox.settings.opacity===null}function k(){if(!e()){a("facebox_overlay").length==0&&a("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');a("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",a.facebox.settings.opacity).click(function(){a(document).trigger("close.facebox")}).fadeIn(200);return false}}function g(){if(!e()){a("#facebox_overlay").fadeOut(200,
function(){a("#facebox_overlay").removeClass("facebox_overlayBG");a("#facebox_overlay").addClass("facebox_hide");a("#facebox_overlay").remove()});return false}}a.facebox=function(d,h){a.facebox.loading();if(d.ajax)n(d.ajax);else if(d.image)m(d.image);else if(d.div)r(d.div);else a.isFunction(d)?d.call(a):a.facebox.reveal(d,h)};a.extend(a.facebox,{settings:{opacity:0.4,overlay:true,imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="javascript:;" class="close"></a>       </div>     </div>'},
loading:function(){c();if(a("#facebox .loading").length==1)return true;k();a("#facebox .content").empty();a("#facebox .body").children().hide().end().append('<div class="loading"></div>');a("#facebox").css({top:b()[1]+i()/10,left:385.5}).show();a(document).bind("keydown.facebox",function(d){d.keyCode==27&&a.facebox.close();return true});a(document).trigger("loading.facebox")},reveal:function(d,h){a(document).trigger("beforeReveal.facebox");h&&a("#facebox .content").addClass(h);a("#facebox .content").append(d);
a("#facebox .loading").remove();a("#facebox .body").children().fadeIn("normal");a("#facebox").css("left",a(window).width()/2-a("#facebox").width()/2);a(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){a(document).trigger("close.facebox");return false}});a.fn.facebox=function(d){c(d);return this.click(function(){a.facebox.loading(true);var h=this.rel.match(/facebox\[?\.(\w+)\]?/);if(h)h=h[1];r(this.href,h);return false})};a(document).bind("close.facebox",function(){a(document).unbind("keydown.facebox");
a("#facebox").fadeOut(function(){a("#facebox .content").removeClass().addClass("content");g();a("#facebox .loading").remove()})})})(jQuery);jQuery(document).ready(function(a){a("a[rel*=facebox]").facebox()});function show_fbox(a){if(jQuery("#facebox").length==0||jQuery("#facebox").css("display")=="none"){jQuery.facebox(a);jQuery("#facebox_overlay").unbind("click")}else{jQuery("#facebox .content").empty();jQuery.facebox.reveal(a)}}function close_fbox(){jQuery(document).trigger("close.facebox")};(function(a){function c(b,i){this.$element=a(b);this.options=i;this.enabled=true;this.fixTitle()}c.prototype={show:function(){var b=this.getTitle();if(b&&this.enabled){var i=this.tip();i.find(".tipsy-inner")[this.options.html?"html":"text"](b);i[0].className="tipsy";i.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);b=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var j=i[0].offsetWidth,r=i[0].offsetHeight,
m=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,n;switch(m.charAt(0)){case "n":n={top:b.top+b.height+this.options.offset,left:b.left+b.width/2-j/2};break;case "s":n={top:b.top-r-this.options.offset,left:b.left+b.width/2-j/2};break;case "e":n={top:b.top+b.height/2-r/2,left:b.left-j-this.options.offset};break;case "w":n={top:b.top+b.height/2-r/2,left:b.left+b.width+this.options.offset};break}if(m.length==2)n.left=m.charAt(1)=="w"?b.left+b.width/
2-15:b.left+b.width/2-j+15;i.css(n).addClass("tipsy-"+m);this.options.fade?i.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):i.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var b=this.$element;if(b.attr("title")||typeof b.attr("original-title")!="string")b.attr("original-title",b.attr("title")||"").removeAttr("title")},
getTitle:function(){var b,i=this.$element,j=this.options;this.fixTitle();j=this.options;if(typeof j.title=="string")b=i.attr(j.title=="title"?"original-title":j.title);else if(typeof j.title=="function")b=j.title.call(i[0]);return(b=(""+b).replace(/(^\s*|\s*$)/,""))||j.fallback},tip:function(){if(!this.$tip)this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();
this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(b){function i(e){var k=a.data(e,"tipsy");if(!k){k=new c(e,a.fn.tipsy.elementOptions(e,b));a.data(e,"tipsy",k)}return k}function j(){var e=i(this);e.hoverState="in";if(b.delayIn==0)e.show();else{e.fixTitle();setTimeout(function(){e.hoverState=="in"&&e.show()},b.delayIn)}}function r(){var e=i(this);e.hoverState="out";
b.delayOut==0?e.hide():setTimeout(function(){e.hoverState=="out"&&e.hide()},b.delayOut)}if(b===true)return this.data("tipsy");else if(typeof b=="string"){var m=this.data("tipsy");m&&m[b]();return this}b=a.extend({},a.fn.tipsy.defaults,b);b.live||this.each(function(){i(this)});if(b.trigger!="manual"){m=b.live?"live":"bind";var n=b.trigger=="hover"?"mouseleave":"blur";this[m](b.trigger=="hover"?"mouseenter":"focus",j)[m](n,r)}return this};a.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",
gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.elementOptions=function(b,i){return a.metadata?a.extend({},i,a(b).metadata()):i};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"}})(jQuery);
