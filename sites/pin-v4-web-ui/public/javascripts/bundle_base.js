pie={html:{},dom:{},data:{},js:{},util:{}};try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}pie.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>=1};pie.isFF=function(){return window.navigator.userAgent.indexOf("Firefox")>=1};pie.isChrome=function(){return window.navigator.userAgent.indexOf("Chrome")>=1};
pie.randstr=function(a){a=a||8;var d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),b=d.length,c=pie.rand(b-10);re=d[c];for(var f=1;f<a;f++){c=pie.rand(b);re+=d[c]}return re};pie.rand=function(a){return Math.round(Math.random()*(a-1))};pie.make_unselectable=function(a,d){d=d||"default";a.onselectstart=function(){return false};a.unselectable="on";a.style.MozUserSelect="none";a.style.webkitUserSelect="none";return a};
pie.make_selectable=function(a){a.onselectstart=function(){return true};a.unselectable="off";a.style.MozUserSelect="";a.style.webkitUserSelect="";return a};
Date.prototype.getFormatValue=function(a){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a))a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var b in d)if(RegExp("("+b+")").test(a))a=a.replace(RegExp.$1,RegExp.$1.length==1?d[b]:("00"+d[b]).substr((""+d[b]).length));return a};
pie.do_click=function(a,d){var b=$(a);if(document.createEvent){var c=document.createEvent("MouseEvents");c.initEvent("click",true,false);b.dispatchEvent(c)}else document.createEventObject&&b.fireEvent("onclick");d&&d.stop()};pie.charslength=function(a){var d,b;for(d=b=0;d<a.length;d++){var c=a.charCodeAt(d);b+=c>=0&&c<=255?1:2}return b};
pie.truncate_u=function(a,d){var b,c;c=0;res="";for(b=0;b<a.length;b++){var f=a.charCodeAt(b),g=a[b];f=f>=0&&f<=255;if(c<d)res+=g+"";c+=f?1:2}if(res.length<a.length)res+="...";return res};pie.highlight=function(a){var d=jQuery(a);d.css("background-color","#FFFADA");d.animate({backgroundColor:"white"},500,function(){d.css("background-color","")})};pie.replace_dom=function(a,d){jQuery(a).hide().fadeIn(200);jQuery(d).before(a);jQuery(d).remove()};
pie.dom.xml={getXMLDoc:function(){var a=null;if(document.implementation&&document.implementation.createDocument)a=document.implementation.createDocument("","",null);else if(typeof ActiveXObject!="undefined")a=new ActiveXObject("MSXML2.DOMDocument");a.async=false;return a},getXMLDocFromString:function(a){var d=null;if(document.implementation&&document.implementation.createDocument){var b=new DOMParser;d=b.parseFromString(a,"text/xml");delete b}else if(typeof ActiveXObject!="undefined"){d=new ActiveXObject("MSXML2.DOMDocument");
d.loadXML(a)}return d},transformXML:function(a,d){if(window.ActiveXObject)return a.documentElement.transformNode(d);else{var b=new XSLTProcessor;b.importStylesheet(d);b=b.transformToFragment(a,document);var c=document.createElement("div");c.appendChild(b);return c.innerHTML}},serialize:function(a){var d=a.xml;if(d==undefined)try{var b=new XMLSerializer;d=b.serializeToString(a);delete b}catch(c){debug&&alert("DOM serialization is not supported.")}return d}};
pie.log=function(){var a=[];for(i=0;i<arguments.length;i++)a.push("arguments["+i+"]");eval("try{console.log("+a.join(",")+")}catch(e){}")};pie.dir=function(){var a=[];for(i=0;i<arguments.length;i++)a.push("arguments["+i+"]");eval("try{console.dir("+a.join(",")+")}catch(e){}")};
pie.open_win=function(a,d,b,c){d=d||520;b=b||420;window.open(a,c||"connect_window","height="+b+", width="+d+", toolbar =no, menubar=no, scrollbars=yes, resizable=no,top="+(document.body.clientHeight-b)/2+",left="+(document.body.clientWidth-d)/2+", location=no, status=no")};pie.load=function(a){jQuery(document).ready(function(){a()})};
if(pie.isFF()){HTMLElement.prototype.contains=function(a){do if(a==this)return true;while(a=a.parentNode);return false};HTMLElement.prototype.__defineGetter__("outerHTML",function(){for(var a,d=this.attributes,b="<"+this.tagName,c=0;c<d.length;c++){a=d[c];if(a.specified)b+=" "+a.name+'="'+a.value+'"'}if(!this.canHaveChildren)return b+">";return b+">"+this.innerHTML+"</"+this.tagName+">"});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())});
Event.prototype.__defineGetter__("fromElement",function(){var a;if(this.type=="mouseover")a=this.relatedTarget;else if(this.type=="mouseout")a=this.target;if(!a)return null;for(;a.nodeType!=1;)a=a.parentNode;return a});Event.prototype.__defineGetter__("toElement",function(){try{var a;if(this.type=="mouseout")a=this.relatedTarget;else if(this.type=="mouseover")a=this.target;if(!a||a.tagName=="INPUT"&&a.type=="file")return null;for(;a.nodeType!=1;)a=a.parentNode;return a}catch(d){}})}
MINDPIN_URLS={production:{user_auth:"http://www.mindpin.com/","pin-user-auth":"http://www.mindpin.com/",discuss:"http://discuss.mindpin.com/","pin-discuss":"http://discuss.mindpin.com/","pin-workspace":"http://workspace.mindpin.com/",ui:"http://ui.mindpin.com/","pin-bugs":"http://bugs.mindpin.com/","pin-app-adapter":"http://app-adapter.mindpin.com/","pin-share":"http://share.mindpin.com/","pin-mindmap-editor":"http://mindmap-editor.mindpin.com/","pin-mindmap-image-cache":"http://mindmap-image-cache.mindpin.com/",
"pin-macro":"http://macro.mindpin.com/","pin-website":"http://website.mindpin.com/","pin-notes":"http://notes.mindpin.com/","pin-mev6":"http://mev6.mindpin.com/"},development:{user_auth:"http://dev.www.mindpin.com/","pin-user-auth":"http://dev.www.mindpin.com/",discuss:"http://dev.discuss.mindpin.com/","pin-discuss":"http://dev.discuss.mindpin.com/","pin-workspace":"http://dev.workspace.mindpin.com/",ui:"http://dev.ui.mindpin.com/","pin-bugs":"http://dev.bugs.mindpin.com/","pin-app-adapter":"http://dev.app-adapter.mindpin.com/",
"pin-share":"http://dev.share.mindpin.com/","pin-mindmap-editor":"http://dev.mindmap-editor.mindpin.com/","pin-mindmap-image-cache":"http://dev.mindmap-image-cache.mindpin.com/","pin-macro":"http://dev.macro.mindpin.com/","pin-website":"http://dev.website.mindpin.com/","pin-notes":"http://dev.notes.mindpin.com/","pin-mev6":"http://dev.mev6.mindpin.com/"}};pie.pin_url_for=function(a,d){var b=MINDPIN_URLS[pie.env][a],c=jQuery.string(d||"");if(c.blank())return b;return b+c.gsub(/^\//,"").str};pie.inputflash=function(a){a.stop().animate({"background-color":"#ffeeee"},100).animate({"background-color":"#ffffff"},100).animate({"background-color":"#ffeeee"},100).animate({"background-color":"#ffffff"},100,function(){a.css("background-color","")})};
pie.inputflashdark=function(a){a.stop().animate({"background-color":"#16181A"},200).animate({"background-color":"#25282B"},200).animate({"background-color":"#16181A"},200).animate({"background-color":"#25282B"},200,function(){a.css("background-color","")})};
pie.load(function(){var a=function(b){b.css("backgroundColor","#292929").animate({backgroundColor:"#E9B51C"},1E3).animate({backgroundColor:"#292929"},{duration:1E3,complete:function(){a(b)}})},d=function(b){b.animate({opacity:0.6},500).animate({opacity:1},{duration:500,complete:function(){d(b)}})};if(pie.env=="development"){jQuery(".devdraft").each(function(){var b=jQuery(this);a(b)});jQuery("[dev-note]").each(function(){var b=jQuery(this),c=jQuery('<div class="dev-note-float"></div>'),f=b.offset();
c.css("left",f.left).css("top",f.top);jQuery("body").append(c);c.tipsy({html:true,title:function(){var g=b.attr("dev-note"),h=jQuery(g);if(h.length==0)return g;return h.html()}});c.bind("dblclick",function(){jQuery(this).remove();jQuery(".tipsy").remove()});d(c)})}});(function(a){function d(){a('html body input[type="text"], html body input[type="password"]').addClass("text");a('input[type="submit"]').addClass("submit");a('input[type="checkbox"]').addClass("checkbox");a("form .fieldWithErrors").closest("div.field").addClass("error");a("form .fieldWithErrors input, form .fieldWithErrors textarea").each(function(b,c){width=a(c).width();a(c).closest("div.field").find(".formError").width(width)})}jQuery(document).ready(d);jQuery(document).bind("reveal.facebox",d)})(jQuery);
(function(a){jQuery(document).ready(function(){a("form select, form .text, form textarea, textarea, input.text").live("focus",function(){a(this).closest("div.field").addClass("active");a(this).closest("fieldset").addClass("active");a(this).addClass("active")}).live("blur",function(){a(this).closest("div.field").removeClass("active");a(this).closest("fieldset").removeClass("active");a(this).removeClass("active")});a("input[type='submit'],a.button").live("mousedown",function(){a(this).addClass("mousedown")}).live("mouseup mouseleave",
function(){a(this).removeClass("mousedown")})})})(jQuery);pie.mindmaps_typeset=function(){};pie.load(pie.mindmaps_typeset);(function(a){jQuery(document).ready(function(){a("button, .minibutton, a.button, a.subbtn, .button a").live("mousedown",function(){a(this).addClass("mousedown")}).live("mouseup mouseleave",function(){a(this).removeClass("mousedown")})})})(jQuery);(function(a){var d="deg";a.fn.rotate=function(f){var g=a(this).css("transform")||"none";if(typeof f=="undefined"){if(g)if((f=g.match(/rotate\(([^)]+)\)/))&&f[1])return f[1];return 0}if(f=f.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/)){if(f[3])d=f[3];a(this).css("transform",g.replace(/none|rotate\([^)]*\)/,"")+"rotate("+f[1]+d+")")}return this};a.fn.scale=function(f){var g=a(this).css("transform");if(typeof f=="undefined"){if(g)if((f=g.match(/scale\(([^)]+)\)/))&&f[1])return f[1];return 1}a(this).css("transform",
g.replace(/none|scale\([^)]*\)/,"")+"scale("+f+")");return this};var b=a.fx.prototype.cur;a.fx.prototype.cur=function(){if(this.prop=="rotate")return parseFloat(a(this.elem).rotate());else if(this.prop=="scale")return parseFloat(a(this.elem).scale());return b.apply(this,arguments)};a.fx.step.rotate=function(f){a(f.elem).rotate(f.now+d)};a.fx.step.scale=function(f){a(f.elem).scale(f.now)};var c=a.fn.animate;a.fn.animate=function(f){if(typeof f.rotate!="undefined"){var g=f.rotate.toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);
if(g&&g[5])d=g[5];f.rotate=g[1]}return c.apply(this,arguments)}})(jQuery);jQuery.extend({__arrayPrototype:{max:function(){return Math.max.apply(Math,this.arr)},max_index:function(){return jQuery.inArray(this.max(),this.arr)},min:function(){return Math.min.apply(Math,this.arr)},min_index:function(){return jQuery.inArray(this.min(),this.arr)}},array:function(a){if(a===Array.prototype)jQuery.extend(Array.prototype,jQuery.__arrayPrototype);else return jQuery.extend({arr:a},jQuery.__arrayPrototype)}});(function(a){function d(c){var f;if(c&&c.constructor==Array&&c.length==3)return c;if(f=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(f[1]),parseInt(f[2]),parseInt(f[3])];if(f=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(f[1])*2.55,parseFloat(f[2])*2.55,parseFloat(f[3])*2.55];if(f=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(f[1],16),parseInt(f[2],
16),parseInt(f[3],16)];if(f=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)];return b[a.trim(c).toLowerCase()]}a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(c,f){a.fx.step[f]=function(g){if(g.state==0){var h;h=g.elem;var l=f,j;do{j=a.curCSS(h,l);if(j!=""&&j!="transparent"||a.nodeName(h,"body"))break;l="backgroundColor"}while(h=h.parentNode);
h=d(j);g.start=h;g.end=d(g.end)}g.elem.style[f]="rgb("+[Math.max(Math.min(parseInt(g.pos*(g.end[0]-g.start[0])+g.start[0]),255),0),Math.max(Math.min(parseInt(g.pos*(g.end[1]-g.start[1])+g.start[1]),255),0),Math.max(Math.min(parseInt(g.pos*(g.end[2]-g.start[2])+g.start[2]),255),0)].join(",")+")"}});var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,
100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,
128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);jQuery.cookie=function(a,d,b){if(arguments.length>1&&String(d)!=="[object Object]"){b=jQuery.extend({},b);if(d===null||d===undefined)b.expires=-1;if(typeof b.expires==="number"){var c=b.expires,f=b.expires=new Date;f.setDate(f.getDate()+c)}d=String(d);return document.cookie=[encodeURIComponent(a),"=",b.raw?d:encodeURIComponent(d),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join("")}b=d||{};f=b.raw?function(g){return g}:
decodeURIComponent;return(c=RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?f(c[1]):null};(function(a){var d=null,b=a.fn.css;a.fn.css=function(c,f){if(d===null)d=typeof a.cssProps!="undefined"?a.cssProps:typeof a.props!="undefined"?a.props:{};if(typeof d.transform=="undefined"&&(c=="transform"||typeof c=="object"&&typeof c.transform!="undefined")){var g=d,h;a:{h=this.get(0);for(var l=["transform","WebkitTransform","msTransform","MozTransform","OTransform"],j;j=l.shift();)if(typeof h.style[j]!="undefined"){h=j;break a}h="transform"}g.transform=h}if(d.transform!="transform")if(c=="transform"){c=
d.transform;if(typeof f=="undefined"&&jQuery.style)return jQuery.style(this.get(0),c)}else if(typeof c=="object"&&typeof c.transform!="undefined"){c[d.transform]=c.transform;delete c.transform}return b.apply(this,arguments)}})(jQuery);(function(a){a.fn.drag=function(f,g,h){var l=typeof f=="string"?f:"",j=a.isFunction(f)?f:a.isFunction(g)?g:null;if(l.indexOf("drag")!==0)l="drag"+l;h=(f==j?g:h)||{};return j?this.bind(l,h,j):this.trigger(l)};var d=a.event,b=d.special,c=b.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:false,drop:true,click:false},datakey:"dragdata",livekey:"livedrag",add:function(f){var g=a.data(this,c.datakey),h=f.data||{};g.related+=1;if(!g.live&&f.selector){g.live=true;d.add(this,"draginit."+
c.livekey,c.delegate)}a.each(c.defaults,function(l){if(h[l]!==undefined)g[l]=h[l]})},remove:function(){a.data(this,c.datakey).related-=1},setup:function(){if(!a.data(this,c.datakey)){var f=a.extend({related:0},c.defaults);a.data(this,c.datakey,f);d.add(this,"mousedown",c.init,f);this.attachEvent&&this.attachEvent("ondragstart",c.dontstart)}},teardown:function(){if(!a.data(this,c.datakey).related){a.removeData(this,c.datakey);d.remove(this,"mousedown",c.init);d.remove(this,"draginit",c.delegate);c.textselect(true);
this.detachEvent&&this.detachEvent("ondragstart",c.dontstart)}},init:function(f){var g=f.data,h;if(!(g.which>0&&f.which!=g.which))if(!a(f.target).is(g.not))if(!(g.handle&&!a(f.target).closest(g.handle,f.currentTarget).length)){g.propagates=1;g.interactions=[c.interaction(this,g)];g.target=f.target;g.pageX=f.pageX;g.pageY=f.pageY;g.dragging=null;h=c.hijack(f,"draginit",g);if(g.propagates){if((h=c.flatten(h))&&h.length){g.interactions=[];a.each(h,function(){g.interactions.push(c.interaction(this,g))})}g.propagates=
g.interactions.length;g.drop!==false&&b.drop&&b.drop.handler(f,g);c.textselect(false);d.add(document,"mousemove mouseup",c.handler,g);return false}}},interaction:function(f,g){return{drag:f,callback:new c.callback,droppable:[],offset:a(f)[g.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(f){var g=f.data;switch(f.type){case !g.dragging&&"mousemove":if(Math.pow(f.pageX-g.pageX,2)+Math.pow(f.pageY-g.pageY,2)<Math.pow(g.distance,2))break;f.target=g.target;c.hijack(f,"dragstart",g);
if(g.propagates)g.dragging=true;case "mousemove":if(g.dragging){c.hijack(f,"drag",g);if(g.propagates){g.drop!==false&&b.drop&&b.drop.handler(f,g);break}f.type="mouseup"}case "mouseup":d.remove(document,"mousemove mouseup",c.handler);if(g.dragging){g.drop!==false&&b.drop&&b.drop.handler(f,g);c.hijack(f,"dragend",g)}c.textselect(true);if(g.click===false&&g.dragging){jQuery.event.triggered=true;setTimeout(function(){jQuery.event.triggered=false},20);g.dragging=false}break}},delegate:function(f){var g=
[],h,l=a.data(this,"events")||{};a.each(l.live||[],function(j,n){if(n.preType.indexOf("drag")===0)if(h=a(f.target).closest(n.selector,f.currentTarget)[0]){d.add(h,n.origType+"."+c.livekey,n.origHandler,n.data);a.inArray(h,g)<0&&g.push(h)}});if(!g.length)return false;return a(g).bind("dragend."+c.livekey,function(){d.remove(this,"."+c.livekey)})},hijack:function(f,g,h,l,j){if(h){var n={event:f.originalEvent,type:f.type},q=g.indexOf("drop")?"drag":"drop",k,p=l||0,w,C;l=!isNaN(l)?l:h.interactions.length;
f.type=g;f.originalEvent=null;h.results=[];do if(w=h.interactions[p])if(!(g!=="dragend"&&w.cancelled)){C=c.properties(f,h,w);w.results=[];a(j||w[q]||h.droppable).each(function(r,y){k=(C.target=y)?d.handle.call(y,f,C):null;if(k===false){if(q=="drag"){w.cancelled=true;h.propagates-=1}if(g=="drop")w[q][r]=null}else if(g=="dropinit")w.droppable.push(c.element(k)||y);if(g=="dragstart")w.proxy=a(c.element(k)||w.drag)[0];w.results.push(k);delete f.result;if(g!=="dropinit")return k});h.results[p]=c.flatten(w.results);
if(g=="dropinit")w.droppable=c.flatten(w.droppable);g=="dragstart"&&!w.cancelled&&C.update()}while(++p<l);f.type=n.type;f.originalEvent=n.event;return c.flatten(h.results)}},properties:function(f,g,h){var l=h.callback;l.drag=h.drag;l.proxy=h.proxy||h.drag;l.startX=g.pageX;l.startY=g.pageY;l.deltaX=f.pageX-g.pageX;l.deltaY=f.pageY-g.pageY;l.originalX=h.offset.left;l.originalY=h.offset.top;l.offsetX=f.pageX-(g.pageX-l.originalX);l.offsetY=f.pageY-(g.pageY-l.originalY);l.drop=c.flatten((h.drop||[]).slice());
l.available=c.flatten((h.droppable||[]).slice());return l},element:function(f){if(f&&(f.jquery||f.nodeType==1))return f},flatten:function(f){return a.map(f,function(g){return g&&g.jquery?a.makeArray(g):g&&g.length?c.flatten(g):g})},textselect:function(f){a(document)[f?"unbind":"bind"]("selectstart",c.dontstart).attr("unselectable",f?"off":"on").css("MozUserSelect",f?"":"none")},dontstart:function(){return false},callback:function(){}};c.callback.prototype={update:function(){b.drop&&this.available.length&&
a.each(this.available,function(f){b.drop.locate(this,f)})}};b.draginit=b.dragstart=b.dragend=c})(jQuery);(function(a){a.fn.drop=function(f,g,h){var l=typeof f=="string"?f:"",j=a.isFunction(f)?f:a.isFunction(g)?g:null;if(l.indexOf("drop")!==0)l="drop"+l;h=(f==j?g:h)||{};return j?this.bind(l,h,j):this.trigger(l)};a.drop=function(f){f=f||{};c.multi=f.multi===true?Infinity:f.multi===false?1:!isNaN(f.multi)?f.multi:c.multi;c.delay=f.delay||c.delay;c.tolerance=a.isFunction(f.tolerance)?f.tolerance:f.tolerance===null?null:c.tolerance;c.mode=f.mode||c.mode||"intersect"};var d=a.event,b=d.special,c=a.event.special.drop=
{multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",livekey:"livedrop",add:function(f){var g=a.data(this,c.datakey);g.related+=1;if(!g.live&&f.selector){g.live=true;d.add(this,"dropinit."+c.livekey,c.delegate)}},remove:function(){a.data(this,c.datakey).related-=1},setup:function(){if(!a.data(this,c.datakey)){a.data(this,c.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}});c.targets.push(this)}},teardown:function(){if(!a.data(this,c.datakey).related){a.removeData(this,c.datakey);
d.remove(this,"dropinit",c.delegate);var f=this;c.targets=a.grep(c.targets,function(g){return g!==f})}},handler:function(f,g){var h;if(g)switch(f.type){case "mousedown":h=a(c.targets);if(typeof g.drop=="string")h=h.filter(g.drop);h.each(function(){var l=a.data(this,c.datakey);l.active=[];l.anyactive=0;l.winner=0});g.droppable=h;c.delegates=[];b.drag.hijack(f,"dropinit",g);c.delegates=a.unique(b.drag.flatten(c.delegates));break;case "mousemove":c.event=f;c.timer||c.tolerate(g);break;case "mouseup":c.timer=
clearTimeout(c.timer);if(g.propagates){b.drag.hijack(f,"drop",g);b.drag.hijack(f,"dropend",g);a.each(c.delegates||[],function(){d.remove(this,"."+c.livekey)})}break}},delegate:function(f){var g=[],h,l=a.data(this,"events")||{};a.each(l.live||[],function(j,n){if(n.preType.indexOf("drop")===0){h=a(f.currentTarget).find(n.selector);h.length&&h.each(function(){d.add(this,n.origType+"."+c.livekey,n.origHandler,n.data);a.inArray(this,g)<0&&g.push(this)})}});c.delegates.push(g);return g.length?a(g):false},
locate:function(f,g){var h=a.data(f,c.datakey),l=a(f),j=l.offset()||{},n=l.outerHeight();l=l.outerWidth();j={elem:f,width:l,height:n,top:j.top,left:j.left,right:j.left+l,bottom:j.top+n};if(h){h.location=j;h.index=g;h.elem=f}return j},contains:function(f,g){return(g[0]||g.left)>=f.left&&(g[0]||g.right)<=f.right&&(g[1]||g.top)>=f.top&&(g[1]||g.bottom)<=f.bottom},modes:{intersect:function(f,g,h){return this.contains(h,[f.pageX,f.pageY])?1E9:this.modes.overlap.apply(this,arguments)},overlap:function(f,
g,h){return Math.max(0,Math.min(h.bottom,g.bottom)-Math.max(h.top,g.top))*Math.max(0,Math.min(h.right,g.right)-Math.max(h.left,g.left))},fit:function(f,g,h){return this.contains(h,g)?1:0},middle:function(f,g,h){return this.contains(h,[g.left+g.width*0.5,g.top+g.height*0.5])?1:0}},sort:function(f,g){return g.winner-f.winner||f.index-g.index},tolerate:function(f){var g,h,l,j,n,q,k=0,p,w=f.interactions.length,C=[c.event.pageX,c.event.pageY],r=c.tolerance||c.modes[c.mode];do if(p=f.interactions[k]){if(!p)return;
p.drop=[];n=[];q=p.droppable.length;if(r)l=c.locate(p.proxy);g=0;do if(h=p.droppable[g]){j=a.data(h,c.datakey);if(h=j.location){j.winner=r?r.call(c,c.event,l,h):c.contains(h,C)?1:0;n.push(j)}}while(++g<q);n.sort(c.sort);g=0;do if(j=n[g])if(j.winner&&p.drop.length<c.multi){if(!j.active[k]&&!j.anyactive)if(b.drag.hijack(c.event,"dropstart",f,k,j.elem)[0]!==false){j.active[k]=1;j.anyactive+=1}else j.winner=0;j.winner&&p.drop.push(j.elem)}else if(j.active[k]&&j.anyactive==1){b.drag.hijack(c.event,"dropend",
f,k,j.elem);j.active[k]=0;j.anyactive-=1}while(++g<q)}while(++k<w);if(c.last&&C[0]==c.last.pageX&&C[1]==c.last.pageY)delete c.timer;else c.timer=setTimeout(function(){c.tolerate(f)},c.delay);c.last=c.event}};b.dropinit=b.dropstart=b.dropend=c})(jQuery);(function(a){function d(h,l,j){h=h.split(f);h[j]=l;return h.join(" ")}var b=document.createElement("div");b=b.style;var c=a.support,f=/\s/,g=/\)\s/;c.boxShadow=b.MozBoxShadow===""?"MozBoxShadow":b.MsBoxShadow===""?"MsBoxShadow":b.WebkitBoxShadow===""?"WebkitBoxShadow":b.OBoxShadow===""?"OBoxShadow":b.boxShadow===""?"BoxShadow":false;b=null;if(c.boxShadow&&c.boxShadow!=="BoxShadow"){a.cssHooks.boxShadow={get:function(h){return a.css(h,c.boxShadow)},set:function(h,l){h.style[c.boxShadow]=l}};a.cssHooks.boxShadowColor=
{get:function(h){return a.css(h,c.boxShadow).split(g)[0]+")"},set:function(h,l){h.style[c.boxShadow]=l+" "+a.css(h,c.boxShadow).split(g)[1]}};a.cssHooks.boxShadowBlur={get:function(h){return a.css(h,c.boxShadow).split(f)[5]},set:function(h,l){h.style[c.boxShadow]=d(a.css(h,c.boxShadow),l,5)}};a.cssHooks.boxShadowSpread={get:function(h){return a.css(h,c.boxShadow).split(f)[6]},set:function(h,l){h.style[c.boxShadow]=d(a.css(h,c.boxShadow),l,6)}};a.cssHooks.boxShadowX={get:function(h){return a.css(h,
c.boxShadow).split(f)[3]},set:function(h,l){h.style[c.boxShadow]=d(a.css(h,c.boxShadow),l,3)}};a.cssHooks.boxShadowY={get:function(h){return a.css(h,c.boxShadow).split(f)[4]},set:function(h,l){h.style[c.boxShadow]=d(a.css(h,c.boxShadow),l,4)}};b="Blur Spread X Y".split(" ");a.each(b,function(h,l){var j="boxShadow"+l;a.fx.step[j]=function(n){a.cssHooks[j].set(n.elem,n.now+n.unit)}})}})(jQuery);jQuery.extend({__stringPrototype:{JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"},blank:function(a){return/^\s*$/.test(this.s(a)||" ")},camelize:function(a){var d=this.s(a).split("-"),b;a=[d[0]];for(b=1;b<d.length;b++)a.push(d[b].charAt(0).toUpperCase()+d[b].substring(1));a=a.join("");return this.r(arguments,0,a)},capitalize:function(a){a=this.s(a);a=a.charAt(0).toUpperCase()+
a.substring(1).toLowerCase();return this.r(arguments,0,a)},dasherize:function(a){a=this.s(a).split("_").join("-");return this.r(arguments,0,a)},empty:function(a){return this.s(a)===""},endsWith:function(a,d){d=this.s(d);var b=d.length-a.length;return b>=0&&d.lastIndexOf(a)===b},escapeHTML:function(a){a=this.s(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return this.r(arguments,0,a)},evalJSON:function(a,d){d=this.s(d);var b=this.unfilterJSON(false,d);try{if(!a||this.isJSON(b))return eval("("+
b+")")}catch(c){}throw new SyntaxError("Badly formed JSON string: "+d);},evalScripts:function(a){a=this.extractScripts(this.s(a));var d=[];if(a.length>0)for(var b=0;b<a.length;b++)d.push(eval(a[b]));return d},extractScripts:function(a){var d=RegExp(this.ScriptFragment,"img"),b=RegExp(this.ScriptFragment,"im");a=this.s(a).match(d)||[];d=[];if(a.length>0)for(var c=0;c<a.length;c++)d.push(a[c].match(b)[1]||"");return d},gsub:function(a,d,b){b=this.s(b);b=jQuery.isFunction(d)?this.sub(a,d,-1,b):b.split(a).join(d);
return this.r(arguments,2,b)},include:function(a,d){return this.s(d).indexOf(a)>-1},inspect:function(a,d){d=this.s(d);var b;try{b=this.sub(/[\x00-\x1f\\]/,function(f){var g=jQuery.__stringPrototype.specialChar[f[0]];return g?g:"\\u00"+f[0].charCodeAt().toPaddedString(2,16)},-1,d)}catch(c){b=d}d=a?'"'+b.replace(/"/g,'\\"')+'"':"'"+b.replace(/'/g,"\\'")+"'";return this.r(arguments,1,d)},interpolate:function(a,d,b){b=this.s(b);d||(d=/(\#\{\s*(\w+)\s*\})/);var c=RegExp(d.source,"g");c=b.match(c);var f;
for(f=0;f<c.length;f++)b=b.replace(c[f],a[c[f].match(d)[2]]);return this.r(arguments,2,b)},isJSON:function(a){a=this.s(a);if(this.blank(a))return false;a=a.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(a)},scan:function(a,d,b){b=this.s(b);this.sub(a,d,-1,b);return this.r(arguments,2,b)},startsWith:function(a,d){return this.s(d).indexOf(a)===0},strip:function(a){a=jQuery.trim(this.s(a));return this.r(arguments,0,a)},stripScripts:function(a){a=this.s(a).replace(RegExp(this.ScriptFragment,
"img"),"");return this.r(arguments,0,a)},stripTags:function(a){a=this.s(a).replace(/<\/?[^>]+>/gi,"");return this.r(arguments,0,a)},sub:function(a,d,b,c){c=this.s(c);if(a.source&&!a.global){var f=a.ignoreCase?"ig":"g";f+=a.multiline?"m":"";a=RegExp(a.source,f)}f=c.split(a);var g=c.match(a);if(jQuery.browser.msie){c.indexOf(g[0])==0&&f.unshift("");c.lastIndexOf(g[g.length-1])==c.length-g[g.length-1].length&&f.push("")}b=b<0?f.length-1:b||1;c=f[0];for(var h=1;h<f.length;h++)c+=h<=b?jQuery.isFunction(d)?
d(g[h-1]||g)+f[h]:d+f[h]:(g[h-1]||g)+f[h];return this.r(arguments,3,c)},succ:function(a){a=this.s(a);a=a.slice(0,a.length-1)+String.fromCharCode(a.charCodeAt(a.length-1)+1);return this.r(arguments,0,a)},times:function(a,d){d=this.s(d);for(var b="",c=0;c<a;c++)b+=d;return this.r(arguments,1,b)},toJSON:function(a){return this.r(arguments,0,this.inspect(true,this.s(a)))},toQueryParams:function(a,d){d=this.s(d);var b=d.substring(d.indexOf("?")+1).split("#")[0].split(a||"&"),c={},f,g,h;for(f=0;f<b.length;f++){h=
b[f].split("=");g=decodeURIComponent(h[0]);h=h[1]?decodeURIComponent(h[1]):undefined;if(c[g]){if(typeof c[g]=="string")c[g]=[c[g]];c[g].push(h)}else c[g]=h}return c},truncate:function(a,d,b){b=this.s(b);a=a||30;d=!d?"...":d;b=b.length>a?b.slice(0,a-d.length)+d:String(b);return this.r(arguments,2,b)},underscore:function(a){a=this.sub(/[A-Z]/,function(d){return"_"+d.toLowerCase()},-1,this.s(a));if(a.charAt(0)=="_")a=a.substring(1);return this.r(arguments,0,a)},unescapeHTML:function(a){a=this.stripTags(this.s(a)).replace(/&amp;/g,
"&").replace(/&lt;/g,"<").replace(/&gt;/g,">");return this.r(arguments,0,a)},unfilterJSON:function(a,d){d=this.s(d);a=a||this.JSONFilter;var b=d.match(a);d=b!==null?b[1]:d;return this.r(arguments,1,jQuery.trim(d))},r:function(a,d,b){if(a.length>d||this.str===undefined)return b;else{this.str=""+b;return this}},s:function(a){if(a===""||a)return a;if(this.str===""||this.str)return this.str;return this}},string:function(a){if(a===String.prototype)jQuery.extend(String.prototype,jQuery.__stringPrototype);
else return jQuery.extend({str:a},jQuery.__stringPrototype)}});jQuery.__stringPrototype.parseQuery=jQuery.__stringPrototype.toQueryParams;(function(a){a.fn.extend({autocomplete:function(d,b){var c=typeof d=="string";b=a.extend({},a.Autocompleter.defaults,{url:c?d:null,data:c?null:d,delay:c?a.Autocompleter.defaults.delay:10,max:b&&!b.scroll?10:150},b);b.highlight=b.highlight||function(f){return f};b.formatMatch=b.formatMatch||b.formatItem;return this.each(function(){new a.Autocompleter(this,b)})},result:function(d){return this.bind("result",d)},search:function(d){return this.trigger("search",[d])},flushCache:function(){return this.trigger("flushCache")},
setOptions:function(d){return this.trigger("setOptions",[d])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(d,b){function c(){var v=z.selected();if(!v)return false;var E=v.result;w=E;if(b.multiple){var F=g(k.val());if(F.length>1){var u=b.multipleSeparator.length,I=a(d).selection().start,J,K=0;a.each(F,function(P,O){K+=O.length;if(I<=K){J=P;return false}K+=u});F[J]=E;E=F.join(b.multipleSeparator)}E+=b.multipleSeparator}k.val(E);l();k.trigger("result",[v.data,
v.value]);return true}function f(v,E){if(y==q.DEL)z.hide();else{var F=k.val();if(!(!E&&F==w)){w=F;F=h(F);if(F.length>=b.minChars){k.addClass(b.loadingClass);b.matchCase||(F=F.toLowerCase());n(F,j,l)}else{k.removeClass(b.loadingClass);z.hide()}}}}function g(v){if(!v)return[""];if(!b.multiple)return[a.trim(v)];return a.map(v.split(b.multipleSeparator),function(E){return a.trim(v).length?a.trim(E):null})}function h(v){if(!b.multiple)return v;var E=g(v);if(E.length==1)return E[0];E=a(d).selection().start;
E=E==v.length?g(v):g(v.replace(v.substring(E),""));return E[E.length-1]}function l(){z.visible();z.hide();clearTimeout(p);k.removeClass(b.loadingClass);b.mustMatch&&k.search(function(v){if(!v)if(b.multiple){v=g(k.val()).slice(0,-1);k.val(v.join(b.multipleSeparator)+(v.length?b.multipleSeparator:""))}else{k.val("");k.trigger("result",null)}})}function j(v,E){if(E&&E.length&&r){k.removeClass(b.loadingClass);z.display(E,v);var F=E[0].value;if(b.autoFill&&h(k.val()).toLowerCase()==v.toLowerCase()&&y!=
q.BACKSPACE){k.val(k.val()+F.substring(h(w).length));a(d).selection(w.length,w.length+F.length)}z.show()}else l()}function n(v,E,F){b.matchCase||(v=v.toLowerCase());var u=C.load(v);if(u&&u.length)E(v,u);else if(typeof b.url=="string"&&b.url.length>0){var I={timestamp:+new Date};a.each(b.extraParams,function(J,K){I[J]=typeof K=="function"?K():K});a.ajax({mode:"abort",port:"autocomplete"+d.name,dataType:b.dataType,url:b.url,data:a.extend({q:h(v),limit:b.max},I),success:function(J){var K;if(!(K=b.parse&&
b.parse(J))){K=[];J=J.split("\n");for(var P=0;P<J.length;P++){var O=a.trim(J[P]);if(O){O=O.split("|");K[K.length]={data:O,value:O[0],result:b.formatResult&&b.formatResult(O,O[0])||O[0]}}}K=K}K=K;C.add(v,K);E(v,K)}})}else{z.emptyList();F(v)}}var q={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},k=a(d).attr("autocomplete","off").addClass(b.inputClass),p,w="",C=a.Autocompleter.Cache(b),r=0,y,L={mouseDownOnSelect:false},z=a.Autocompleter.Select(b,d,c,L),D;a.browser.opera&&
a(d.form).bind("submit.autocomplete",function(){if(D)return D=false});k.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(v){r=1;y=v.keyCode;switch(v.keyCode){case q.UP:v.preventDefault();z.visible()?z.prev():f(0,true);break;case q.DOWN:v.preventDefault();z.visible()?z.next():f(0,true);break;case q.PAGEUP:v.preventDefault();z.visible()?z.pageUp():f(0,true);break;case q.PAGEDOWN:v.preventDefault();z.visible()?z.pageDown():f(0,true);break;case b.multiple&&a.trim(b.multipleSeparator)==
","&&q.COMMA:case q.TAB:case q.RETURN:if(c()){v.preventDefault();D=true;return false}break;case q.ESC:z.hide();break;default:clearTimeout(p);p=setTimeout(f,b.delay);break}}).focus(function(){r++}).blur(function(){r=0;if(!L.mouseDownOnSelect){clearTimeout(p);p=setTimeout(l,200)}}).click(function(){r++>1&&!z.visible()&&f(0,true)}).bind("search",function(){function v(F,u){var I;if(u&&u.length)for(var J=0;J<u.length;J++)if(u[J].result.toLowerCase()==F.toLowerCase()){I=u[J];break}typeof E=="function"?
E(I):k.trigger("result",I&&[I.data,I.value])}var E=arguments.length>1?arguments[1]:null;a.each(g(k.val()),function(F,u){n(u,v,v)})}).bind("flushCache",function(){C.flush()}).bind("setOptions",function(v,E){a.extend(b,E);"data"in E&&C.populate()}).bind("unautocomplete",function(){z.unbind();k.unbind();a(d.form).unbind(".autocomplete")}).bind("input",function(){f(0,true)})};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,
matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(d){return d[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(d,b){return d.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(d){function b(j,n){d.matchCase||(j=
j.toLowerCase());var q=j.indexOf(n);if(d.matchContains=="word")q=j.toLowerCase().search("\\b"+n.toLowerCase());if(q==-1)return false;return q==0||d.matchContains}function c(j,n){l>d.cacheLength&&g();h[j]||l++;h[j]=n}function f(){if(!d.data)return false;var j={},n=0;if(!d.url)d.cacheLength=1;j[""]=[];for(var q=0,k=d.data.length;q<k;q++){var p=d.data[q];p=typeof p=="string"?[p]:p;var w=d.formatMatch(p,q+1,d.data.length);if(w!==false){var C=w.charAt(0).toLowerCase();j[C]||(j[C]=[]);p={value:w,data:p,
result:d.formatResult&&d.formatResult(p)||w};j[C].push(p);n++<d.max&&j[""].push(p)}}a.each(j,function(r,y){d.cacheLength++;c(r,y)})}function g(){h={};l=0}var h={},l=0;setTimeout(f,25);return{flush:g,add:c,populate:f,load:function(j){if(!d.cacheLength||!l)return null;if(!d.url&&d.matchContains){var n=[];for(var q in h)if(q.length>0){var k=h[q];a.each(k,function(p,w){b(w.value,j)&&n.push(w)})}return n}else if(h[j])return h[j];else if(d.matchSubset)for(q=j.length-1;q>=d.minChars;q--)if(k=h[j.substr(0,
q)]){n=[];a.each(k,function(p,w){if(b(w.value,j))n[n.length]=w});return n}return null}}};a.Autocompleter.Select=function(d,b,c,f){function g(){if(w){C=a("<div/>").hide().addClass(d.resultsClass).css("position","absolute").appendTo(document.body);r=a("<ul/>").appendTo(C).mouseover(function(y){if(h(y).nodeName&&h(y).nodeName.toUpperCase()=="LI"){q=a("li",r).removeClass(j.ACTIVE).index(h(y));a(h(y)).addClass(j.ACTIVE)}}).click(function(y){a(h(y)).addClass(j.ACTIVE);c();b.focus();return false}).mousedown(function(){f.mouseDownOnSelect=
true}).mouseup(function(){f.mouseDownOnSelect=false});d.width>0&&C.css("width",d.width);w=false}}function h(y){for(y=y.target;y&&y.tagName!="LI";)y=y.parentNode;if(!y)return[];return y}function l(y){n.slice(q,q+1).removeClass(j.ACTIVE);q+=y;if(q<0)q=n.size()-1;else if(q>=n.size())q=0;y=n.slice(q,q+1).addClass(j.ACTIVE);if(d.scroll){var L=0;n.slice(0,q).each(function(){L+=this.offsetHeight});if(L+y[0].offsetHeight-r.scrollTop()>r[0].clientHeight)r.scrollTop(L+y[0].offsetHeight-r.innerHeight());else L<
r.scrollTop()&&r.scrollTop(L)}}var j={ACTIVE:"ac_over"},n,q=-1,k,p="",w=true,C,r;return{display:function(y,L){g();k=y;p=L;r.empty();for(var z=d.max&&d.max<k.length?d.max:k.length,D=0;D<z;D++)if(k[D]){var v=d.formatItem(k[D].data,D+1,z,k[D].value,p);if(v!==false){v=a("<li/>").html(d.highlight(v,p)).addClass(D%2==0?"ac_even":"ac_odd").appendTo(r)[0];a.data(v,"ac_data",k[D])}}n=r.find("li");if(d.selectFirst){n.slice(0,1).addClass(j.ACTIVE);q=0}a.fn.bgiframe&&r.bgiframe()},next:function(){l(1)},prev:function(){l(-1)},
pageUp:function(){q!=0&&q-8<0?l(-q):l(-8)},pageDown:function(){q!=n.size()-1&&q+8>n.size()?l(n.size()-1-q):l(8)},hide:function(){C&&C.hide();n&&n.removeClass(j.ACTIVE);q=-1},visible:function(){return C&&C.is(":visible")},current:function(){return this.visible()&&(n.filter("."+j.ACTIVE)[0]||d.selectFirst&&n[0])},show:function(){var y=a(b).offset();C.css({width:typeof d.width=="string"||d.width>0?d.width:a(b).outerWidth()-2,top:y.top+b.offsetHeight,left:y.left}).show();if(d.scroll){r.scrollTop(0);r.css({maxHeight:d.scrollHeight,
overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var L=0;n.each(function(){L+=this.offsetHeight});y=L>d.scrollHeight;r.css("height",y?d.scrollHeight:L);y||n.width(r.width()-parseInt(n.css("padding-left"))-parseInt(n.css("padding-right")))}}},selected:function(){var y=n&&n.filter("."+j.ACTIVE).removeClass(j.ACTIVE);return y&&y.length&&a.data(y[0],"ac_data")},emptyList:function(){r&&r.empty()},unbind:function(){C&&C.remove()}}};a.fn.selection=function(d,b){if(d!==
undefined)return this.each(function(){if(this.createTextRange){var l=this.createTextRange();if(b===undefined||d==b)l.move("character",d);else{l.collapse(true);l.moveStart("character",d);l.moveEnd("character",b)}l.select()}else if(this.setSelectionRange)this.setSelectionRange(d,b);else if(this.selectionStart){this.selectionStart=d;this.selectionEnd=b}});var c=this[0];if(c.createTextRange){var f=document.selection.createRange(),g=c.value,h=f.text.length;f.text="<->";f=c.value.indexOf("<->");c.value=
g;this.selection(f,f+h);return{start:f,end:f+h}}else if(c.selectionStart!==undefined)return{start:c.selectionStart,end:c.selectionEnd}}})(jQuery);(function(a){function d(k){if(a.facebox.settings.inited)return true;else a.facebox.settings.inited=true;a(document).trigger("init.facebox");f();var p=a.facebox.settings.imageTypes.join("|");a.facebox.settings.imageTypesRegexp=RegExp(".("+p+")$","i");k&&a.extend(a.facebox.settings,k);a("body").append(a.facebox.settings.faceboxHtml);var w=[new Image,new Image];a("#facebox").find(".b:first, .bl").each(function(){w.push(new Image);w.slice(-1).src=a(this).css("background-image").replace(/url\((.+)\)/,
"$1")});a("#facebox .close").click(a.facebox.close)}function b(){var k,p;if(self.pageYOffset){p=self.pageYOffset;k=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){p=document.documentElement.scrollTop;k=document.documentElement.scrollLeft}else if(document.body){p=document.body.scrollTop;k=document.body.scrollLeft}return Array(k,p)}function c(){var k;if(self.innerHeight)k=self.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)k=
document.documentElement.clientHeight;else if(document.body)k=document.body.clientHeight;return k}function f(){var k=a.facebox.settings;k.imageTypes=k.image_types||k.imageTypes;k.faceboxHtml=k.facebox_html||k.faceboxHtml}function g(k,p){if(k.match(/#/)){var w=window.location.href.split("#")[0];w=k.replace(w,"");w!="#"&&a.facebox.reveal(a(w).html(),p)}else k.match(a.facebox.settings.imageTypesRegexp)?h(k,p):l(k,p)}function h(k,p){var w=new Image;w.onload=function(){a.facebox.reveal('<div class="image"><img src="'+
w.src+'" /></div>',p)};w.src=k}function l(k,p){a.get(k,function(w){a.facebox.reveal(w,p)})}function j(){return a.facebox.settings.overlay==false||a.facebox.settings.opacity===null}function n(){if(!j()){a("#facebox_overlay").length==0&&a("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');a("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",a.facebox.settings.opacity).click(function(){a(document).trigger("close.facebox")}).fadeIn(200);return false}}function q(){if(!j()){a("#facebox_overlay").fadeOut(200,
function(){a("#facebox_overlay").removeClass("facebox_overlayBG");a("#facebox_overlay").addClass("facebox_hide");a("#facebox_overlay").remove()});return false}}a.facebox=function(k,p){a.facebox.loading();if(k.ajax)l(k.ajax,p);else if(k.image)h(k.image,p);else if(k.div)g(k.div,p);else a.isFunction(k)?k.call(a):a.facebox.reveal(k,p)};a.extend(a.facebox,{settings:{opacity:0.4,overlay:true,imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="javascript:;" class="close"></a>       </div>     </div>'},
loading:function(){d();if(a("#facebox .loading").length==1)return true;n();a("#facebox .content").empty().append('<div class="loading"></div>');a("#facebox").css({top:b()[1]+c()/3-a("#facebox").height()/3,left:a(window).width()/2-a("#facebox").width()/2}).show();a(document).bind("keydown.facebox",function(k){k.keyCode==27&&a.facebox.close();return true});a(document).trigger("loading.facebox")},reveal:function(k,p){a(document).trigger("beforeReveal.facebox");p&&a("#facebox .content").addClass(p);a("#facebox .loading").remove();
a("#facebox .content").empty().append(k);a("#facebox .body").children().fadeIn("normal");a("#facebox").css({top:b()[1]+c()/3-a("#facebox").height()/3,left:a(window).width()/2-a("#facebox").width()/2}).show();a(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){a(document).trigger("close.facebox");return false}});a.fn.facebox=function(k){if(a(this).length!=0){d(k);return this.bind("click.facebox",function(){a.facebox.loading(true);var p=this.rel.match(/facebox\[?\.(\w+)\]?/);
if(p)p=p[1];g(this.href,p);return false})}};a(document).bind("close.facebox",function(){a(document).unbind("keydown.facebox");a("#facebox").fadeOut(function(){a("#facebox .content").removeClass().addClass("content");a("#facebox .loading").remove();a(document).trigger("afterClose.facebox")});q()})})(jQuery);jQuery(document).ready(function(a){a("a[rel*=facebox]").facebox()});function show_fbox(a){if(jQuery("#facebox").length==0||jQuery("#facebox").css("display")=="none"){jQuery.facebox(a);jQuery("#facebox_overlay").unbind("click")}else{jQuery("#facebox .content").empty();jQuery.facebox.reveal(a)}}function close_fbox(){jQuery(document).trigger("close.facebox")};(function(a){function d(b,c){var f=a('<div class="quiet j-input-tip">'+c+"</div>");f.css("position","absolute");f.css("font-size",b.css("font-size"));var g=b.offset(),h=g.left+parseInt(b.css("padding-left"))+2;g=g.top+parseInt(b.css("padding-top"))+1;f.css("left",h).css("top",g);b.val()!=""&&f.hide();f.mousedown(function(){f.hide();setTimeout(function(){b.focus()},1)});b.after(f)}a.fn.input_tips=function(b){var c=a(this);d(c,b);a(this).focus(function(){c.next(".j-input-tip").hide()}).blur(function(){var f=
c.next(".j-input-tip");c.val()==""&&f.show()})};a(document).ready(function(){a("[data-input-tip]").each(function(){var b=a(this);b.input_tips(b.attr("data-input-tip"))})})})(jQuery);jQuery.fn.input=function(a){var d=this;return a?d.bind({"input.input":function(b){d.unbind("keydown.input");a.call(this,b)},"keydown.input":function(b){a.call(this,b)}}):d.trigger("keydown.input")};
pie.load(function(){function a(d){var b=d.closest(".field").find("label");d=d.val();jQuery.string(d).blank()?b.show():b.hide()}jQuery.fn.pie_j_tips=function(){var d=jQuery(this);d.closest(".field").find("label").mousedown(function(){setTimeout(function(){d.focus()},1)});a(d);d.change(function(){a(d)}).input(function(){a(d)})};jQuery(".j-tip").each(function(){jQuery(this).pie_j_tips()})});QEDITOR_TOOLBAR_HTML='<div class="qeditor-toolbar">   <a href="javascript:;" onclick="return QEditor.action(this,\'bold\');" title="\u52a0\u7c97"><b>B</b></a>   <a href="javascript:;" onclick="return QEditor.action(this,\'italic\');" title="\u503e\u659c"><i>I</i></a>   <a href="javascript:;" onclick="return QEditor.action(this,\'underline\');" title="\u4e0b\u5212\u7ebf"><u>U</u></a>   <a href="javascript:;" class="qeditor_glast" onclick="return QEditor.action(this,\'strikethrough\');" title="\u5220\u9664\u7ebf" alt="\u5220\u9664\u7ebf"><strike>S</strike></a>\t\t   <a href="javascript:;" onclick="return QEditor.action(this,\'formatBlock\',\'address\');"><img src="/images/qeditor/quote.gif" title="\u5f15\u7528" alt="\u5f15\u7528" /></a>   <a href="javascript:;" onclick="return QEditor.action(this,\'insertorderedlist\');"><img src="/images/qeditor/ol.gif" title="\u6709\u5e8f\u5217\u8868" alt="\u6709\u5e8f\u5217\u8868" /></a>   <a href="javascript:;" class="qeditor_glast" onclick="return QEditor.action(this,\'insertunorderedlist\');"><img src="/images/qeditor/ul.gif" title="\u65e0\u5e8f\u5217\u8868" alt="\u65e0\u5e8f\u5217\u8868" /></a>   <a href="javascript:;" class="qeditor_glast" style="display:none;" onclick="return QEditor.action(this,\'insertimage\',prompt(\'Image URL\'));"><img src="/images/qeditor/image.gif" title="\u63d2\u5165\u56fe\u7247" alt="\u63d2\u5165\u56fe\u7247" /></a> </div>';
QEditor={action:function(a,d,b){qeditor_preview=jQuery(".qeditor-preview",jQuery(a).parent().parent());qeditor_preview.focus();if(b==null)b=false;if(d=="insertcode")alert("TODO: inser [code][/code]");else{pie.log(d);document.execCommand(d,false,b)}qeditor_preview!=undefined&&qeditor_preview.change();return false},renderToolbar:function(a){a.parent().prepend(QEDITOR_TOOLBAR_HTML)},version:function(){return"0.1"}};
(function(a){a.fn.qeditor=function(d){return d==false?this.each(function(){var b=a(this);b.parent().find(".qeditor-toolbar").detach();b.parent().find(".qeditor-preview").detach();b.unwrap()}):this.each(function(){var b=a(this);b.addClass("qeditor");if(d&&d.is_mobile_device){var c=a('<input type="hidden" name="did_editor_content_formatted" value="no">');b.after(c)}else{c=a('<div class="qeditor-preview" contentEditable="true"></div>');c.html(b.val());b.after(c);c.change(function(){pobj=a(this);t=pobj.parent().find(".qeditor");
t.val(pobj.html())});c.keyup(function(){a(this).change()});b.hide();b.wrap('<div class="jquery-qeditor"></div>');b.after(c);QEditor.renderToolbar(c)}})}})(jQuery);(function(a){function d(b,c){this.$element=a(b);this.options=c;this.enabled=true;this.fixTitle()}d.prototype={show:function(){var b=this.getTitle();if(b&&this.enabled){var c=this.tip();c.find(".tipsy-inner")[this.options.html?"html":"text"](b);c[0].className="tipsy";c.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);b=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var f=c[0].offsetWidth,g=c[0].offsetHeight,
h=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,l;switch(h.charAt(0)){case "n":l={top:b.top+b.height+this.options.offset,left:b.left+b.width/2-f/2};break;case "s":l={top:b.top-g-this.options.offset,left:b.left+b.width/2-f/2};break;case "e":l={top:b.top+b.height/2-g/2,left:b.left-f-this.options.offset};break;case "w":l={top:b.top+b.height/2-g/2,left:b.left+b.width+this.options.offset};break}if(h.length==2)l.left=h.charAt(1)=="w"?b.left+b.width/
2-15:b.left+b.width/2-f+15;c.css(l).addClass("tipsy-"+h);this.options.fade?c.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):c.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var b=this.$element;if(b.attr("title")||typeof b.attr("original-title")!="string")b.attr("original-title",b.attr("title")||"").removeAttr("title")},
getTitle:function(){var b,c=this.$element,f=this.options;this.fixTitle();f=this.options;if(typeof f.title=="string")b=c.attr(f.title=="title"?"original-title":f.title);else if(typeof f.title=="function")b=f.title.call(c[0]);return(b=(""+b).replace(/(^\s*|\s*$)/,""))||f.fallback},tip:function(){if(!this.$tip)this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();
this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(b){function c(j){var n=a.data(j,"tipsy");if(!n){n=new d(j,a.fn.tipsy.elementOptions(j,b));a.data(j,"tipsy",n)}return n}function f(){var j=c(this);j.hoverState="in";if(b.delayIn==0)j.show();else{j.fixTitle();setTimeout(function(){j.hoverState=="in"&&j.show()},b.delayIn)}}function g(){var j=c(this);j.hoverState="out";
b.delayOut==0?j.hide():setTimeout(function(){j.hoverState=="out"&&j.hide()},b.delayOut)}if(b===true)return this.data("tipsy");else if(typeof b=="string"){var h=this.data("tipsy");h&&h[b]();return this}b=a.extend({},a.fn.tipsy.defaults,b);b.live||this.each(function(){c(this)});if(b.trigger!="manual"){h=b.live?"live":"bind";var l=b.trigger=="hover"?"mouseleave":"blur";this[h](b.trigger=="hover"?"mouseenter":"focus",f)[h](l,g)}return this};a.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",
gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.elementOptions=function(b,c){return a.metadata?a.extend({},c,a(b).metadata()):c};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"}})(jQuery);(function(a){a(document).ready(function(){a("[original-title]").tipsy({html:true});a("[tip]").tipsy({html:true,title:function(){var d=this.getAttribute("tip"),b=a(d);if(b.length==0)return d;return b.html()}});a("[tipr]").tipsy({html:true,gravity:"w",title:function(){var d=this.getAttribute("tipr"),b=a(d);if(b.length==0)return d;return b.html()}})})})(jQuery);jQuery&&function(a){a.extend(a.fn,{uploadify:function(d){a(this).each(function(){var b=a.extend({id:a(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:120,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:false,displayData:"percentage",removeCompleted:true,onInit:function(){},onSelect:function(){},onSelectOnce:function(){},onQueueFull:function(){},
onCheck:function(){},onCancel:function(){},onClearQueue:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},d);a(this).data("settings",b);var c=location.pathname;c=c.split("/");c.pop();c=c.join("/")+"/";var f={};f.uploadifyID=b.id;f.pagepath=c;if(b.buttonImg)f.buttonImg=escape(b.buttonImg);if(b.buttonText)f.buttonText=escape(b.buttonText);if(b.rollover)f.rollover=true;f.script=b.script;f.folder=escape(b.folder);if(b.scriptData){var g="";for(var h in b.scriptData)g+=
"&"+h+"="+b.scriptData[h];f.scriptData=escape(g.substr(1))}f.width=b.width;f.height=b.height;f.wmode=b.wmode;f.method=b.method;f.queueSizeLimit=b.queueSizeLimit;f.simUploadLimit=b.simUploadLimit;if(b.hideButton)f.hideButton=true;if(b.fileDesc)f.fileDesc=b.fileDesc;if(b.fileExt)f.fileExt=b.fileExt;if(b.multi)f.multi=true;if(b.auto)f.auto=true;if(b.sizeLimit)f.sizeLimit=b.sizeLimit;if(b.checkScript)f.checkScript=b.checkScript;if(b.fileDataName)f.fileDataName=b.fileDataName;if(b.queueID)f.queueID=b.queueID;
if(b.onInit()!==false){a(this).css("display","none");a(this).after('<div id="'+a(this).attr("id")+'Uploader"></div>');swfobject.embedSWF(b.uploader,b.id+"Uploader",b.width,b.height,"9.0.24",b.expressInstall,f,{quality:"high",wmode:b.wmode,allowScriptAccess:b.scriptAccess},{},function(j){typeof b.onSWFReady=="function"&&j.success&&b.onSWFReady()});b.queueID==false?a("#"+a(this).attr("id")+"Uploader").after('<div id="'+a(this).attr("id")+'Queue" class="uploadifyQueue"></div>'):a("#"+b.queueID).addClass("uploadifyQueue")}typeof b.onOpen==
"function"&&a(this).bind("uploadifyOpen",b.onOpen);a(this).bind("uploadifySelect",{action:b.onSelect,queueID:b.queueID},function(j,n,q){if(j.data.action(j,n,q)!==false){var k=Math.round(q.size/1024*100)*0.01,p="KB";if(k>1E3){k=Math.round(k*0.0010*100)*0.01;p="MB"}k=k.toString().split(".");k=k.length>1?k[0]+"."+k[1].substr(0,2):k[0];fileName=q.name.length>20?q.name.substr(0,20)+"...":q.name;queue="#"+a(this).attr("id")+"Queue";if(j.data.queueID)queue="#"+j.data.queueID;a(queue).append('<div id="'+
a(this).attr("id")+n+'" class="uploadifyQueueItem"><div class="cancel"><a href="javascript:jQuery(\'#'+a(this).attr("id")+"').uploadifyCancel('"+n+'\')"><img src="'+b.cancelImg+'" border="0" /></a></div><span class="fileName">'+fileName+" ("+k+p+')</span><span class="percentage"></span><div class="uploadifyProgress"><div id="'+a(this).attr("id")+n+'ProgressBar" class="uploadifyProgressBar"><!--Progress Bar--\></div></div></div>')}});a(this).bind("uploadifySelectOnce",{action:b.onSelectOnce},function(j,
n){j.data.action(j,n);if(b.auto)b.checkScript?a(this).uploadifyUpload(null,false):a(this).uploadifyUpload(null,true)});a(this).bind("uploadifyQueueFull",{action:b.onQueueFull},function(j,n){j.data.action(j,n)!==false&&alert("The queue is full.  The max size is "+n+".")});a(this).bind("uploadifyCheckExist",{action:b.onCheck},function(j,n,q,k,p){var w={};w=q;w.folder=k.substr(0,1)=="/"?k:c+k;if(p)for(var C in q)var r=C;a.post(n,w,function(y){for(var L in y)if(j.data.action(j,y,L)!==false)confirm("Do you want to replace the file "+
y[L]+"?")||document.getElementById(a(j.target).attr("id")+"Uploader").cancelFileUpload(L,true,true);p?document.getElementById(a(j.target).attr("id")+"Uploader").startFileUpload(r,true):document.getElementById(a(j.target).attr("id")+"Uploader").startFileUpload(null,true)},"json")});a(this).bind("uploadifyCancel",{action:b.onCancel},function(j,n,q,k,p,w){if(j.data.action(j,n,q,k,w)!==false)if(p){j=w==true?0:250;a("#"+a(this).attr("id")+n).fadeOut(j,function(){a(this).remove()})}});a(this).bind("uploadifyClearQueue",
{action:b.onClearQueue},function(j,n){var q=b.queueID?b.queueID:a(this).attr("id")+"Queue";n&&a("#"+q).find(".uploadifyQueueItem").remove();j.data.action(j,n)!==false&&a("#"+q).find(".uploadifyQueueItem").each(function(){var k=a(".uploadifyQueueItem").index(this);a(this).delay(k*100).fadeOut(250,function(){a(this).remove()})})});var l=[];a(this).bind("uploadifyError",{action:b.onError},function(j,n,q,k){if(j.data.action(j,n,q,k)!==false){j=Array(n,q,k);l.push(j);a("#"+a(this).attr("id")+n).find(".percentage").text(" - "+
k.type+" Error");a("#"+a(this).attr("id")+n).find(".uploadifyProgress").hide();a("#"+a(this).attr("id")+n).addClass("uploadifyError")}});typeof b.onUpload=="function"&&a(this).bind("uploadifyUpload",b.onUpload);a(this).bind("uploadifyProgress",{action:b.onProgress,toDisplay:b.displayData},function(j,n,q,k){if(j.data.action(j,n,q,k)!==false){a("#"+a(this).attr("id")+n+"ProgressBar").animate({width:k.percentage+"%"},250,function(){k.percentage==100&&a(this).closest(".uploadifyProgress").fadeOut(250,
function(){a(this).remove()})});if(j.data.toDisplay=="percentage")displayData=" - "+k.percentage+"%";if(j.data.toDisplay=="speed")displayData=" - "+k.speed+"KB/s";if(j.data.toDisplay==null)displayData=" ";a("#"+a(this).attr("id")+n).find(".percentage").text(displayData)}});a(this).bind("uploadifyComplete",{action:b.onComplete},function(j,n,q,k,p){if(j.data.action(j,n,q,unescape(k),p)!==false){a("#"+a(this).attr("id")+n).find(".percentage").text(" - Completed");b.removeCompleted&&a("#"+a(j.target).attr("id")+
n).fadeOut(250,function(){a(this).remove()});a("#"+a(j.target).attr("id")+n).addClass("completed")}});typeof b.onAllComplete=="function"&&a(this).bind("uploadifyAllComplete",{action:b.onAllComplete},function(j,n){if(j.data.action(j,n)!==false)l=[]})})},uploadifySettings:function(d,b,c){var f=false;a(this).each(function(){if(d=="scriptData"&&b!=null){var n=c?b:a.extend(a(this).data("settings").scriptData,b),q="";for(var k in n)q+="&"+k+"="+n[k];b=escape(q.substr(1))}f=document.getElementById(a(this).attr("id")+
"Uploader").updateSettings(d,b)});if(b==null)if(d=="scriptData"){for(var g=unescape(f).split("&"),h={},l=0;l<g.length;l++){var j=g[l].split("=");h[j[0]]=j[1]}f=h}return f},uploadifyUpload:function(d,b){a(this).each(function(){b||(b=false);document.getElementById(a(this).attr("id")+"Uploader").startFileUpload(d,b)})},uploadifyCancel:function(d){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").cancelFileUpload(d,true,true,false)})},uploadifyClearQueue:function(){a(this).each(function(){document.getElementById(a(this).attr("id")+
"Uploader").clearFileUploadQueue(false)})}})}(jQuery);(function(a){a(document).ready(function(){a("[data-load-url]").each(function(){var d=jQuery(this),b=d.attr("data-load-url");d.addClass("aj-loading");jQuery.ajax({type:"GET",url:b,success:function(c){d.html(c);d.removeClass("aj-loading")}})})})})(jQuery);
pie.load(function(){pie.env=="development"&&jQuery('<div class="rc5">DEVELOPMENT</div>').css("height",40).css("font-size",36).css("line-height","40px").css("position","fixed").css("padding",10).css("left",10).css("top",82).css("color","white").css("background","rgba(0,0,0,0.6)").css("z-index",99).appendTo(jQuery("body"))});pie.show_page_overlay=function(){jQuery('<div class="page-overlay"></div>').css("height",jQuery(document).height()).css("width",jQuery(document).width()).css("opacity",0.6).hide().fadeIn(200).appendTo(jQuery(document.body))};
pie.hide_page_overlay=function(){jQuery(".page-overlay").fadeOut(200,function(){jQuery(".page-overlay").remove()})};pie.show_loading_bar=function(){var a=jQuery('<div class="ajax-loading-bar"><div class="icon"></div>\u6b63\u5728\u52a0\u8f7d\u2026</div>');jQuery("body").append(a);return a};pie.hide_loading_bar=function(){jQuery(".ajax-loading-bar").remove()};jQuery("body").bind("ajaxStart",function(){pie.show_loading_bar()}).bind("ajaxComplete",function(){pie.hide_loading_bar()});pie.load(function(){jQuery(".flash-error, .flash-notice, .flash-success").each(function(){jQuery(this).fadeOut("fast").fadeIn("fast")})});
pie.load(function(){if(jQuery.browser.msie){var a=jQuery.browser.version;if(a=="7.0"||a=="6.0")jQuery("a").attr("hideFocus","hidefocus")}});
pie.load(function(){jQuery.fn.confirm_dialog=function(a,d){var b=jQuery(this),c=b.offset(),f=jQuery('<div class="jq-confirm-dialog popdiv"><div class="d"><div class="data"><div class="icon">?</div>'+a+'</div><div class="btns"><a class="button editable-submit" href="javascript:;">\u786e\u5b9a</a><a class="button editable-cancel" href="javascript:;">\u53d6\u6d88</a></div></div></div>');jQuery(".jq-confirm-dialog").remove();f.css("left",c.left-100+b.outerWidth()/2).css("top",c.top-83);jQuery("body").append(f);
f.hide().fadeIn(200);pie.show_page_overlay();jQuery(".jq-confirm-dialog .editable-submit").unbind();jQuery(".jq-confirm-dialog .editable-submit").bind("click",function(){jQuery(".jq-confirm-dialog").remove();pie.hide_page_overlay();d()})};jQuery(".jq-confirm-dialog .editable-cancel").live("click",function(){jQuery(".jq-confirm-dialog").remove();pie.hide_page_overlay()})});
pie.load(function(){var a=null,d=jQuery("<div class='tag-aj-info'>haha</div>");jQuery(".tag[rel=tag]").live("mouseenter",function(){var b=a=jQuery(this);jQuery(".tag-aj-info").remove();setTimeout(function(){if(a==b){var c=a.offset(),f=c.left;c=c.top+a.height();d.css("left",f).css("top",c+2);d.html("<div class='box'></div>");d.addClass("aj-loading");jQuery("body").append(d);f=a.attr("data-name");jQuery.ajax({url:"/tags/"+f+"/aj_info",type:"GET",global:false,success:function(g){d.html(g);d.removeClass("aj-loading")}})}},
500)}).live("mouseleave",function(){var b=jQuery(this);setTimeout(function(){if(a==null||a.attr("data-name")==b.attr("data-name")){a=null;jQuery(".tag-aj-info").remove()}},100)});jQuery(".tag-aj-info").live("mouseenter",function(){a=jQuery(this)}).live("mouseleave",function(){a=null;jQuery(".tag-aj-info").remove()})});(function(a){a.fn.domdata=function(d,b){return jQuery(this).attr("data-"+d,b)}})(jQuery);
pie.load_cut_img=function(a,d,b,c){var f=jQuery('<img style="display:none;" src="'+a+'" />');b.show().empty().append(f);f.bind("load",function(){(c||function(){})();f.fadeIn(500);g(d,f)});var g=function(h,l){var j=h.width(),n=h.height(),q=l.width(),k=l.height(),p;if(q!=j){p=j;k=k*j/q}else{p=q;k=k}if(k<n){q=n;p=p*n/k}else{q=k;p=p}j=(j-p)/2;n=(n-q)/2;l.css("width",p).css("height",q);l.css("margin-left",j).css("margin-top",n)}};(function(){function a(d){var b=new Date,c=b.valueOf(),f=d.valueOf();c=c-f;if(c<0)return"\u7247\u523b\u524d";if(c<6E4)return parseInt(c/1E3)+"\u79d2\u524d";if(c<36E5)return parseInt(c/6E4)+"\u5206\u949f\u524d";if(c<864E5&&d.getDate()==b.getDate())return d.getFormatValue("hh:mm");if(d.getYear()==b.getYear())return d.getFormatValue("M\u6708d\u65e5 hh:mm");return d.getFormatValue("yyyy\u5e74M\u6708d\u65e5 hh:mm")}jQuery.fn.extend({refresh_time:function(){this.each(function(){var d=jQuery(this),b=d.attr("data-date");
if(b){var c=new Date;c.setTime(b*1E3);b=a(c);d.text(b)}})}});jQuery(document).ready(function(){setInterval(function(){jQuery("span[data-date]").refresh_time()},3E4)})})();(function(a){a.fn.editable=function(d,b){if("disable"==d)a(this).data("disabled.editable",true);else if("enable"==d)a(this).data("disabled.editable",false);else if("destroy"==d)a(this).unbind(a(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");else{var c=a.extend({},a.fn.editable.defaults,{target:d},b),f=a.editable.types[c.type].plugin||function(){},g=a.editable.types[c.type].submit||function(){},h=a.editable.types[c.type].buttons||a.editable.types.defaults.buttons,
l=a.editable.types[c.type].content||a.editable.types.defaults.content,j=a.editable.types[c.type].element||a.editable.types.defaults.element,n=a.editable.types[c.type].reset||a.editable.types.defaults.reset,q=c.callback||function(){},k=c.onedit||function(){},p=c.onsubmit||function(){},w=c.onreset||function(){},C=c.onerror||n;c.tooltip&&a(this).attr("title",c.tooltip);c.autowidth="auto"==c.width;c.autoheight="auto"==c.height;return this.each(function(){var r=this,y=a(r).width(),L=a(r).height();a(this).data("event.editable",
c.event);a.trim(a(this).html())||a(this).html(c.placeholder);a(this).bind(c.event,function(z){if(true!==a(this).data("disabled.editable"))if(!r.editing)if(false!==k.apply(this,[c,r])){z.preventDefault();z.stopPropagation();c.tooltip&&a(r).removeAttr("title");if(0==a(r).width()){c.width=y;c.height=L}else{if(c.width!="none")c.width=c.autowidth?a(r).width():c.width;if(c.height!="none")c.height=c.autoheight?a(r).height():c.height}a(this).html().toLowerCase().replace(/(;|")/g,"")==c.placeholder.toLowerCase().replace(/(;|")/g,
"")&&a(this).html("");r.editing=true;r.revert=a(r).html();a(r).html("");var D=a("<form />");if(c.cssclass)"inherit"==c.cssclass?D.attr("class",a(r).attr("class")):D.attr("class",c.cssclass);if(c.style)if("inherit"==c.style){D.attr("style",a(r).attr("style"));D.css("display",a(r).css("display"))}else D.attr("style",c.style);var v=j.apply(D,[c,r]),E;if(c.loadurl){var F=setTimeout(function(){v.disabled=true;l.apply(D,[c.loadtext,c,r])},100);z={};z[c.id]=r.id;a.isFunction(c.loaddata)?a.extend(z,c.loaddata.apply(r,
[r.revert,c])):a.extend(z,c.loaddata);a.ajax({type:c.loadtype,url:c.loadurl,data:z,async:false,success:function(u){window.clearTimeout(F);E=u;v.disabled=false}})}else if(c.data){E=c.data;if(a.isFunction(c.data))E=c.data.apply(r,[r.revert,c])}else E=r.revert;l.apply(D,[E,c,r]);v.attr("name",c.name);h.apply(D,[c,r]);a(r).append(D);f.apply(D,[c,r]);a(":input:visible:enabled:first",D).focus();c.select&&v.select();v.keydown(function(u){if(u.keyCode==27){u.preventDefault();n.apply(D,[c,r])}});if("cancel"==
c.onblur)v.blur(function(){F=setTimeout(function(){n.apply(D,[c,r])},500)});else if("submit"==c.onblur)v.blur(function(){F=setTimeout(function(){D.submit()},200)});else a.isFunction(c.onblur)?v.blur(function(){c.onblur.apply(r,[v.val(),c])}):v.blur(function(){});D.submit(function(u){F&&clearTimeout(F);u.preventDefault();if(false!==p.apply(D,[c,r]))if(false!==g.apply(D,[c,r]))if(a.isFunction(c.target)){u=c.target.apply(r,[v.val(),c]);a(r).html(u);r.editing=false;q.apply(r,[r.innerHTML,c]);a.trim(a(r).html())||
a(r).html(c.placeholder)}else{u={};u[c.name]=v.val();u[c.id]=r.id;a.isFunction(c.submitdata)?a.extend(u,c.submitdata.apply(r,[r.revert,c])):a.extend(u,c.submitdata);if("PUT"==c.method)u._method="put";a(r).html(c.indicator);var I={type:"POST",data:u,dataType:"html",url:c.target,success:function(J){I.dataType=="html"&&a(r).html(J);r.editing=false;q.apply(r,[J,c]);a.trim(a(r).html())||a(r).html(c.placeholder)},error:function(J){C.apply(D,[c,r,J])}};a.extend(I,c.ajaxoptions);a.ajax(I)}a(r).attr("title",
c.tooltip);return false})}});this.reset=function(z){if(this.editing)if(false!==w.apply(z,[c,r])){a(r).html(r.revert);r.editing=false;a.trim(a(r).html())||a(r).html(c.placeholder);c.tooltip&&a(r).attr("title",c.tooltip)}}})}};a.editable={types:{defaults:{element:function(){var d=a('<input type="hidden"></input>');a(this).append(d);return d},content:function(d){a(":input:first",this).val(d)},reset:function(d,b){b.reset(this)},buttons:function(d,b){var c=this;if(d.submit){if(d.submit.match(/>$/))var f=
a(d.submit).click(function(){f.attr("type")!="submit"&&c.submit()});else{f=a('<button class="editable-submit" type="submit" />');f.html(d.submit)}a(this).append(f)}if(d.cancel){if(d.cancel.match(/>$/))var g=a(d.cancel);else{g=a('<button class="editable-cancel" type="cancel" />');g.html(d.cancel)}a(this).append(g);a(g).click(function(){(a.isFunction(a.editable.types[d.type].reset)?a.editable.types[d.type].reset:a.editable.types.defaults.reset).apply(c,[d,b]);return false})}}},text:{element:function(d){var b=
a("<input />");d.width!="none"&&b.width(d.width);d.height!="none"&&b.height(d.height);b.attr("autocomplete","off");a(this).append(b);return b}},textarea:{element:function(d){var b=a("<textarea />");if(d.rows)b.attr("rows",d.rows);else d.height!="none"&&b.height(d.height);if(d.cols)b.attr("cols",d.cols);else d.width!="none"&&b.width(d.width);a(this).append(b);return b}},select:{element:function(){var d=a("<select />");a(this).append(d);return d},content:function(d,b,c){if(String==d.constructor)eval("var json = "+
d);else var f=d;for(var g in f)if(f.hasOwnProperty(g))if("selected"!=g){d=a("<option />").val(g).append(f[g]);a("select",this).append(d)}a("select",this).children().each(function(){if(a(this).val()==f.selected||a(this).text()==a.trim(c.revert))a(this).attr("selected","selected")})}}},addInputType:function(d,b){a.editable.types[d]=b}};a.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",
loaddata:{},submitdata:{},ajaxoptions:{}}})(jQuery);pie.form_post=function(a,d){var b=jQuery("<form></form>").attr("method","POST").attr("action",a).hide(),c=jQuery("<input />").attr("type","hidden").attr("name","_method").attr("value",d),f=jQuery("<input />").attr("type","hidden").attr("name","authenticity_token").attr("value",decodeURIComponent(decodeURIComponent(pie.auth_token)));b.append(c);b.append(f);jQuery(document.body).append(b);b.submit()};pie.load(function(){jQuery(document).delegate(".page-anonymous-wrapper .login-box .login-form a.login-submit","click",function(){a(jQuery(this).closest("form"))});jQuery(document).delegate(".page-anonymous-wrapper .login-box .login-form input.text","keydown",function(d){d.keyCode==13&&a(jQuery(this).closest("form"))});jQuery(document).delegate(".page-anonymous-wrapper .signup-box .signup-form a.signup-submit","click",function(){a(jQuery(this).closest("form"))});jQuery(document).delegate(".page-anonymous-wrapper .signup-box .signup-form input.text",
"keydown",function(d){d.keyCode==13&&a(jQuery(this).closest("form"))});jQuery(document).delegate(".page-anonymous-wrapper .reset-password-box form a.reset-password-submit","click",function(){a(jQuery(this).closest("form"))});jQuery(document).delegate(".page-anonymous-wrapper .reset-password-box form input.text","keydown",function(d){d.keyCode==13&&a(jQuery(this).closest("form"))});var a=function(d){var b=true;d.find(".field .need").each(function(){var c=jQuery(this);if(jQuery.string(c.val()).blank()){b=
false;pie.inputflashdark(c)}});b&&d.submit()};jQuery(document).delegate(".aj-submit-form a.a-link-submit","click",function(){a(jQuery(this).closest("form"))});jQuery(document).delegate(".aj-submit-form input.text","keydown",function(d){d.keyCode==13&&a(jQuery(this).closest("form"))})});var swfobject=function(){function a(){if(!T){try{var m=u.getElementsByTagName("body")[0].appendChild(u.createElement("span"));m.parentNode.removeChild(m)}catch(o){return}T=true;m=K.length;for(var s=0;s<m;s++)K[s]()}}function d(m){if(T)m();else K[K.length]=m}function b(m){if(typeof F.addEventListener!=z)F.addEventListener("load",m,false);else if(typeof u.addEventListener!=z)u.addEventListener("load",m,false);else if(typeof F.attachEvent!=z)w(F,"onload",m);else if(typeof F.onload=="function"){var o=
F.onload;F.onload=function(){o();m()}}else F.onload=m}function c(){var m=u.getElementsByTagName("body")[0],o=u.createElement(D);o.setAttribute("type",v);var s=m.appendChild(o);if(s){var x=0;(function(){if(typeof s.GetVariable!=z){var A=s.GetVariable("$version");if(A){A=A.split(" ")[1].split(",");B.pv=[parseInt(A[0],10),parseInt(A[1],10),parseInt(A[2],10)]}}else if(x<10){x++;setTimeout(arguments.callee,10);return}m.removeChild(o);s=null;f()})()}else f()}function f(){var m=P.length;if(m>0)for(var o=
0;o<m;o++){var s=P[o].id,x=P[o].callbackFn,A={success:false,id:s};if(B.pv[0]>0){var H=p(s);if(H)if(C(P[o].swfVersion)&&!(B.wk&&B.wk<312)){y(s,true);if(x){A.success=true;A.ref=g(s);x(A)}}else if(P[o].expressInstall&&h()){A={};A.data=P[o].expressInstall;A.width=H.getAttribute("width")||"0";A.height=H.getAttribute("height")||"0";if(H.getAttribute("class"))A.styleclass=H.getAttribute("class");if(H.getAttribute("align"))A.align=H.getAttribute("align");var G={};H=H.getElementsByTagName("param");for(var M=
H.length,N=0;N<M;N++)if(H[N].getAttribute("name").toLowerCase()!="movie")G[H[N].getAttribute("name")]=H[N].getAttribute("value");l(A,G,s,x)}else{j(H);x&&x(A)}}else{y(s,true);if(x){if((s=g(s))&&typeof s.SetVariable!=z){A.success=true;A.ref=s}x(A)}}}}function g(m){var o=null;if((m=p(m))&&m.nodeName=="OBJECT")if(typeof m.SetVariable!=z)o=m;else if(m=m.getElementsByTagName(D)[0])o=m;return o}function h(){return!X&&C("6.0.65")&&(B.win||B.mac)&&!(B.wk&&B.wk<312)}function l(m,o,s,x){X=true;ca=x||null;ea=
{success:false,id:s};var A=p(s);if(A){if(A.nodeName=="OBJECT"){V=n(A);Y=null}else{V=A;Y=s}m.id=E;if(typeof m.width==z||!/%$/.test(m.width)&&parseInt(m.width,10)<310)m.width="310";if(typeof m.height==z||!/%$/.test(m.height)&&parseInt(m.height,10)<137)m.height="137";u.title=u.title.slice(0,47)+" - Flash Player Installation";x=B.ie&&B.win?"ActiveX":"PlugIn";x="MMredirectURL="+F.location.toString().replace(/&/g,"%26")+"&MMplayerType="+x+"&MMdoctitle="+u.title;if(typeof o.flashvars!=z)o.flashvars+="&"+
x;else o.flashvars=x;if(B.ie&&B.win&&A.readyState!=4){x=u.createElement("div");s+="SWFObjectNew";x.setAttribute("id",s);A.parentNode.insertBefore(x,A);A.style.display="none";(function(){A.readyState==4?A.parentNode.removeChild(A):setTimeout(arguments.callee,10)})()}q(m,o,s)}}function j(m){if(B.ie&&B.win&&m.readyState!=4){var o=u.createElement("div");m.parentNode.insertBefore(o,m);o.parentNode.replaceChild(n(m),o);m.style.display="none";(function(){m.readyState==4?m.parentNode.removeChild(m):setTimeout(arguments.callee,
10)})()}else m.parentNode.replaceChild(n(m),m)}function n(m){var o=u.createElement("div");if(B.win&&B.ie)o.innerHTML=m.innerHTML;else if(m=m.getElementsByTagName(D)[0])if(m=m.childNodes)for(var s=m.length,x=0;x<s;x++)!(m[x].nodeType==1&&m[x].nodeName=="PARAM")&&m[x].nodeType!=8&&o.appendChild(m[x].cloneNode(true));return o}function q(m,o,s){var x,A=p(s);if(B.wk&&B.wk<312)return x;if(A){if(typeof m.id==z)m.id=s;if(B.ie&&B.win){var H="";for(var G in m)if(m[G]!=Object.prototype[G])if(G.toLowerCase()==
"data")o.movie=m[G];else if(G.toLowerCase()=="styleclass")H+=' class="'+m[G]+'"';else if(G.toLowerCase()!="classid")H+=" "+G+'="'+m[G]+'"';G="";for(var M in o)if(o[M]!=Object.prototype[M])G+='<param name="'+M+'" value="'+o[M]+'" />';A.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+H+">"+G+"</object>";O[O.length]=m.id;x=p(m.id)}else{M=u.createElement(D);M.setAttribute("type",v);for(var N in m)if(m[N]!=Object.prototype[N])if(N.toLowerCase()=="styleclass")M.setAttribute("class",
m[N]);else N.toLowerCase()!="classid"&&M.setAttribute(N,m[N]);for(H in o)if(o[H]!=Object.prototype[H]&&H.toLowerCase()!="movie"){m=M;G=H;N=o[H];s=u.createElement("param");s.setAttribute("name",G);s.setAttribute("value",N);m.appendChild(s)}A.parentNode.replaceChild(M,A);x=M}}return x}function k(m){var o=p(m);if(o&&o.nodeName=="OBJECT")if(B.ie&&B.win){o.style.display="none";(function(){if(o.readyState==4){var s=p(m);if(s){for(var x in s)if(typeof s[x]=="function")s[x]=null;s.parentNode.removeChild(s)}}else setTimeout(arguments.callee,
10)})()}else o.parentNode.removeChild(o)}function p(m){var o=null;try{o=u.getElementById(m)}catch(s){}return o}function w(m,o,s){m.attachEvent(o,s);U[U.length]=[m,o,s]}function C(m){var o=B.pv;m=m.split(".");m[0]=parseInt(m[0],10);m[1]=parseInt(m[1],10)||0;m[2]=parseInt(m[2],10)||0;return o[0]>m[0]||o[0]==m[0]&&o[1]>m[1]||o[0]==m[0]&&o[1]==m[1]&&o[2]>=m[2]?true:false}function r(m,o,s,x){if(!(B.ie&&B.mac)){var A=u.getElementsByTagName("head")[0];if(A){s=s&&typeof s=="string"?s:"screen";if(x)da=Q=null;
if(!Q||da!=s){x=u.createElement("style");x.setAttribute("type","text/css");x.setAttribute("media",s);Q=A.appendChild(x);if(B.ie&&B.win&&typeof u.styleSheets!=z&&u.styleSheets.length>0)Q=u.styleSheets[u.styleSheets.length-1];da=s}if(B.ie&&B.win)Q&&typeof Q.addRule==D&&Q.addRule(m,o);else Q&&typeof u.createTextNode!=z&&Q.appendChild(u.createTextNode(m+" {"+o+"}"))}}}function y(m,o){if(fa){var s=o?"visible":"hidden";if(T&&p(m))p(m).style.visibility=s;else r("#"+m,"visibility:"+s)}}function L(m){return/[\\\"<>\.;]/.exec(m)!=
null&&typeof encodeURIComponent!=z?encodeURIComponent(m):m}var z="undefined",D="object",v="application/x-shockwave-flash",E="SWFObjectExprInst",F=window,u=document,I=navigator,J=false,K=[function(){J?c():f()}],P=[],O=[],U=[],V,Y,ca,ea,T=false,X=false,Q,da,fa=true,B=function(){var m=typeof u.getElementById!=z&&typeof u.getElementsByTagName!=z&&typeof u.createElement!=z,o=I.userAgent.toLowerCase(),s=I.platform.toLowerCase(),x=s?/win/.test(s):/win/.test(o);s=s?/mac/.test(s):/mac/.test(o);o=/webkit/.test(o)?
parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var A=!+"\u000b1",H=[0,0,0],G=null;if(typeof I.plugins!=z&&typeof I.plugins["Shockwave Flash"]==D){if((G=I.plugins["Shockwave Flash"].description)&&!(typeof I.mimeTypes!=z&&I.mimeTypes[v]&&!I.mimeTypes[v].enabledPlugin)){J=true;A=false;G=G.replace(/^.*\s+(\S+\s+\S+$)/,"$1");H[0]=parseInt(G.replace(/^(.*)\..*$/,"$1"),10);H[1]=parseInt(G.replace(/^.*\.(.*)\s.*$/,"$1"),10);H[2]=/[a-zA-Z]/.test(G)?parseInt(G.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),
10):0}}else if(typeof F.ActiveXObject!=z)try{var M=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(M)if(G=M.GetVariable("$version")){A=true;G=G.split(" ")[1].split(",");H=[parseInt(G[0],10),parseInt(G[1],10),parseInt(G[2],10)]}}catch(N){}return{w3:m,pv:H,wk:o,ie:A,win:x,mac:s}}();(function(){if(B.w3){if(typeof u.readyState!=z&&u.readyState=="complete"||typeof u.readyState==z&&(u.getElementsByTagName("body")[0]||u.body))a();if(!T){typeof u.addEventListener!=z&&u.addEventListener("DOMContentLoaded",
a,false);if(B.ie&&B.win){u.attachEvent("onreadystatechange",function(){if(u.readyState=="complete"){u.detachEvent("onreadystatechange",arguments.callee);a()}});F==top&&function(){if(!T){try{u.documentElement.doScroll("left")}catch(m){setTimeout(arguments.callee,0);return}a()}}()}B.wk&&function(){T||(/loaded|complete/.test(u.readyState)?a():setTimeout(arguments.callee,0))}();b(a)}}})();(function(){B.ie&&B.win&&window.attachEvent("onunload",function(){for(var m=U.length,o=0;o<m;o++)U[o][0].detachEvent(U[o][1],
U[o][2]);m=O.length;for(o=0;o<m;o++)k(O[o]);for(var s in B)B[s]=null;B=null;for(var x in swfobject)swfobject[x]=null;swfobject=null})})();return{registerObject:function(m,o,s,x){if(B.w3&&m&&o){var A={};A.id=m;A.swfVersion=o;A.expressInstall=s;A.callbackFn=x;P[P.length]=A;y(m,false)}else x&&x({success:false,id:m})},getObjectById:function(m){if(B.w3)return g(m)},embedSWF:function(m,o,s,x,A,H,G,M,N,W){var Z={success:false,id:o};if(B.w3&&!(B.wk&&B.wk<312)&&m&&o&&s&&x&&A){y(o,false);d(function(){s+="";
x+="";var S={};if(N&&typeof N===D)for(var R in N)S[R]=N[R];S.data=m;S.width=s;S.height=x;R={};if(M&&typeof M===D)for(var aa in M)R[aa]=M[aa];if(G&&typeof G===D)for(var ba in G)if(typeof R.flashvars!=z)R.flashvars+="&"+ba+"="+G[ba];else R.flashvars=ba+"="+G[ba];if(C(A)){aa=q(S,R,o);S.id==o&&y(o,true);Z.success=true;Z.ref=aa}else if(H&&h()){S.data=H;l(S,R,o,W);return}else y(o,true);W&&W(Z)})}else W&&W(Z)},switchOffAutoHideShow:function(){fa=false},ua:B,getFlashPlayerVersion:function(){return{major:B.pv[0],
minor:B.pv[1],release:B.pv[2]}},hasFlashPlayerVersion:C,createSWF:function(m,o,s){if(B.w3)return q(m,o,s)},showExpressInstall:function(m,o,s,x){B.w3&&h()&&l(m,o,s,x)},removeSWF:function(m){B.w3&&k(m)},createCSS:function(m,o,s,x){B.w3&&r(m,o,s,x)},addDomLoadEvent:d,addLoadEvent:b,getQueryParamValue:function(m){var o=u.location.search||u.location.hash;if(o){if(/\?/.test(o))o=o.split("?")[1];if(m==null)return L(o);o=o.split("&");for(var s=0;s<o.length;s++)if(o[s].substring(0,o[s].indexOf("="))==m)return L(o[s].substring(o[s].indexOf("=")+
1))}return""},expressInstallCallback:function(){if(X){var m=p(E);if(m&&V){m.parentNode.replaceChild(V,m);if(Y){y(Y,true);if(B.ie&&B.win)V.style.display="block"}ca&&ca(ea)}X=false}}}}();pie.load(function(){jQuery(".page-channel-meta-title .op .delete").click(function(){var a=jQuery(this),d=a.domdata("id");a.domdata("to-href");a.confirm_dialog("\u786e\u5b9a\u5220\u9664\u5417",function(){pie.form_post("/channels/"+d,"delete")})})});pie.load(function(){var a=jQuery(".page-new-channel-op");if(a[0]){var d=jQuery(".page-new-channel-op .btn"),b=jQuery(".page-new-channel-op .form"),c=jQuery(".page-new-channel-op form"),f=jQuery(".page-new-channel-op .form .ct"),g=jQuery(".page-new-channel-op .form .create-submit"),h=jQuery(".page-new-channel-op .form .create-cancel"),l=jQuery(".page-channels-set");d.live("click",function(){var n=d.outerWidth(),q=d.outerHeight();b.css("width",n).css("height",q).css("opacity",0).show().delay(10).animate({width:300,
height:f.outerHeight(),opacity:1},200,function(){b.css("height","")});f.fadeIn(200)});var j=function(){if(b.is(":visible")){b.animate({width:d.outerWidth(),height:d.outerHeight(),opacity:0},200,function(){b.hide()});f.fadeOut(200)}};jQuery(document).bind("click.page-new-channel-op",function(n){n=n.target;var q=a[0];q==n||jQuery.contains(q,n)||jQuery.contains(document.body,n)&&j()});h.live("click",function(){j()});g.live("click",function(){var n=c.serialize(),q=true;c.find(".field .need").each(function(){var p=
jQuery(this);if(jQuery.string(p.val()).blank()){q=false;pie.inputflash(p)}});if(q){var k=jQuery('<div class="aj-loading"></div>');jQuery.ajax({url:"/channels",type:"post",data:n,beforeSend:function(){j();l.prepend(k)},success:function(p){k.remove();p=jQuery(p);l.prepend(p.hide().fadeIn())},error:function(){k.addClass("error").delay(500).fadeOut()}})}})}});pie.load(function(){jQuery(document).delegate(".page-feeds .feed a.add-comment","click",function(){var a=jQuery(this).closest(".feed"),d=a.find(".comments");a.find(".page-comment-form").length==0&&d.after('<div class="page-comment-form"><div class="ipt"><textarea class="inputer"/></div><div class="btns"><a class="button editable-submit" href="javascript:;">\u53d1\u9001</a><a class="button editable-cancel" href="javascript:;">\u53d6\u6d88</a></div></div>')});jQuery(".page-feeds .feed .page-comment-form .btns .editable-cancel").live("click",
function(){jQuery(this).closest(".feed").find(".page-comment-form").remove()});jQuery(".page-feeds .feed .page-comment-form .btns .editable-submit").live("click",function(){var a=jQuery(this).closest(".feed"),d=a.domdata("id"),b=a.find(".page-comment-form"),c=b.find(".ipt .inputer").val();jQuery.ajax({url:"/feeds/"+d+"/comments",type:"post",data:"content="+encodeURIComponent(c),success:function(f){f=jQuery(f);a.find(".comments").show().append(f);f.hide().fadeIn(200);b.remove()}})});jQuery(".page-feeds .feed .comments .comment .delete").live("click",
function(){var a=jQuery(this),d=a.closest(".comments"),b=a.closest(".comment"),c=b.attr("data-id");a.confirm_dialog("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u8bc4\u8bba\u5417",function(){jQuery.ajax({url:"/feed_comments/"+c,type:"delete",success:function(){b.fadeOut(200,function(){b.remove();d.find(".comment").length==0&&d.remove()})}})})});jQuery(".page-feeds .feed .comments .comment .reply").live("click",function(){var a=jQuery(this),d=a.closest(".comment").attr("data-creator-name");a=a.closest(".feed");
var b=a.find(".comments");a.find(".page-comment-form").length==0&&b.after('<div class="page-comment-form"><div class="ipt"><textarea class="inputer"/></div><div class="btns"><a class="button editable-submit" href="javascript:;">\u53d1\u9001</a><a class="button editable-cancel" href="javascript:;">\u53d6\u6d88</a></div></div>');a.find(".page-comment-form .inputer").focus().val("\u56de\u590d@"+d+":")})});pie.load(function(){function a(c){c=jQuery(c).find(".comment");b.val("");d.find(".comments .comment.blank").remove();d.find(".comments").prepend(c);c.hide().fadeIn(200);var f=c.next(".comment");c.domdata("user-name")==f.domdata("user-name")&&f.addClass("same-user")}if(jQuery(".page-feed-show-comments").length!=0){var d=jQuery(".page-feed-show-comments"),b=jQuery(".page-feed-show-comments .comment-form").find("textarea.comment-ipter");b.val("");jQuery(".page-feed-show-comments .comment-form a.commit").bind("click",
function(){var c=jQuery(this).closest(".comment-form"),f=b.val().strip();if(jQuery.string(f).blank()){c.find(".submit-info").stop().css("opacity",1).html("\u8bf7\u586b\u5199\u8bc4\u8bba\u5185\u5bb9").show().fadeOut(5E3);pie.inputflash(b)}else{var g=b.domdata("reply-comment-id"),h=d.find(".comments .comment[data-id="+g+"]");if(h.length>0){h="\u56de\u590d@"+h.domdata("user-name")+":";if(jQuery.string(f).startsWith(h)){pie.log("reply");jQuery.ajax({url:"/post_comments/reply",type:"post",data:"reply_comment_id="+
g+"&content="+encodeURIComponent(f),beforeSend:function(){},success:function(l){a(l)}});return}}c=c.domdata("feed-id");jQuery.ajax({url:"/feeds/"+c+"/comments",type:"post",data:"content="+encodeURIComponent(f),beforeSend:function(){},success:function(l){a(l)}})}});jQuery(".page-feed-show-comments .comment .ops a.delete").live("click",function(){var c=jQuery(this);c.confirm_dialog("\u786e\u5b9a\u5220\u9664\u5417",function(){var f=c.closest(".comment"),g=f.domdata("id");jQuery.ajax({url:"/post_comments/"+
g,type:"delete",success:function(){f.fadeOut(200,function(){f.next(".comment").removeClass("same-user");f.remove()})}})})});jQuery(".page-feed-show-comments .comment .ops a.reply").live("click",function(){var c=jQuery(this).closest(".comment"),f=c.domdata("user-name");c=c.domdata("id");f="\u56de\u590d@"+f+":";b.focus().val(f).domdata("reply-comment-id",c)})}});pie.load(function(){jQuery(".user-follow-op a.follow").live("click",function(){var a=jQuery(this).closest(".user-follow-op");a.attr("data-id");a.find(".channel-selector").fadeIn(200)});jQuery(".user-follow-op .channel-selector .ch").live("click",function(){var a=jQuery(this),d=a.closest(".user-follow-op"),b=d.attr("data-id");a=a.attr("data-id");pie.log(b,a);d.find(".channel-selector").fadeOut(100);jQuery.ajax({type:"POST",url:"/contacts/follow",data:"user_id="+b+"&channel_ids="+a,success:function(){jQuery(".user-follow-op a.follow").hide();
jQuery(".user-follow-op a.unfollow").show()}})});jQuery(".user-follow-op a.unfollow").live("click",function(){var a=jQuery(this).closest(".user-follow-op").attr("data-id");jQuery.ajax({type:"DELETE",url:"/contacts/unfollow",data:"user_id="+a,success:function(){jQuery(".user-follow-op a.follow").show();jQuery(".user-follow-op a.unfollow").hide()}})})});pie.load(function(){jQuery(document).delegate(".page-olist.mindmaps .mindmap .m-ops .do-private","click",function(){var a=jQuery(this),d=a.closest(".mindmap").domdata("id");jQuery.ajax({url:"/mindmaps/"+d+"/toggle_private",type:"PUT",success:function(b){b=="true"?a.addClass("private").removeClass("public"):a.removeClass("private").addClass("public")}})});jQuery(document).delegate(".page-olist.mindmaps .mindmap .m-ops .delete","click",function(){var a=jQuery(this),d=a.closest(".mindmap"),b=d.domdata("id");
jQuery(a).confirm_dialog("\u786e\u5b9a\u8981\u5220\u9664\u5417",function(){jQuery.ajax({url:"/mindmaps/"+b,type:"DELETE",success:function(){if(jQuery(".page-mindmaps-top").length>0)d.fadeOut(400,function(){d.remove()});else window.location.href="/"}})})});jQuery(document).delegate(".page-olist.mindmaps .mindmap .m-ops .do-fav","click",function(){var a=jQuery(this),d=a.closest(".mindmap"),b=d.domdata("id"),c=d.find(".fav-star .count");jQuery.ajax({url:"/mindmaps/"+b+"/toggle_fav",type:"PUT",success:function(f){if(f==
"true"){a.addClass("faved").removeClass("not-faved");c.html(parseInt(c.html())+1)}else{a.removeClass("faved").addClass("not-faved");c.html(parseInt(c.html())-1)}}})});jQuery(document).delegate(".page-olist.mindmaps .mindmap .refresh-thumb","click",function(){var a=jQuery(this).closest(".mindmap"),d=a.domdata("id"),b=a.find(".thumb img");jQuery.ajax({url:"/mindmaps/"+d+"/refresh_thumb?size_param=500x500",type:"PUT",success:function(c){b.attr("src",c)}})})});pie.load(function(){var a=jQuery(".page-new-collection-op");if(a[0]){var d=a.find(".create"),b=a.find(".pop-box"),c=a.find("form"),f=b.find(".form-placeholder"),g=a.find("a.create-submit"),h=a.find("a.create-cancel"),l=a.find("input.ipt-title"),j=jQuery(".page-ogrid.collections"),n=j.find(".list-blank");d.live("click",function(){var k=d.outerWidth(),p=d.outerHeight();pie.show_page_overlay();l.val("");b.css("width",k).css("height",p).css("opacity",0).show().delay(10).animate({width:300,height:f.outerHeight(),
opacity:1},200,function(){b.css("height","")});f.fadeIn(200)});var q=function(){if(b.is(":visible")){pie.hide_page_overlay();b.animate({width:d.outerWidth(),height:d.outerHeight(),opacity:0},200,function(){b.hide()});f.fadeOut(200)}};jQuery(document).bind("click.page-new-collection-op",function(k){k=k.target;var p=a[0];p==k||jQuery.contains(p,k)||jQuery.contains(document.body,k)&&q()});h.live("click",function(){q()});g.live("click",function(){var k=c.serialize(),p=true;c.find(".field .need").each(function(){var C=
jQuery(this);if(jQuery.string(C.val()).blank()){p=false;pie.inputflash(C)}});var w=c.find(".sendto-hid");if(jQuery.string(w.val()).blank()){p=false;pie.inputflash(c.find(".sendto-ipter"))}p&&jQuery.ajax({url:"/collections",type:"post",data:k,beforeSend:function(){q()},success:function(C){n.remove();C=jQuery(C);j.prepend(C.hide().fadeIn())},error:function(){}})})}});pie.load(function(){function a(g,h){var l=g.find("input[type=checkbox]");if(h){g.addClass("checked");l.attr("checked",true)}else{g.removeClass("checked");l.attr("checked",false)}}var d=jQuery(".page-new-feed-form");if(d.length!=0){var b=jQuery(".page-new-feed-form-side"),c=d.find(".loaded_draft_mark").length>0,f=d.find(".aimed_collection_mark").length>0;if(!c){d.find(".title-ipter").val("");d.find(".photos-ipter").val("");d.find(".detail-ipter").val("");d.find(".collections-ipter").val("");f&&d.find(".collections-ipter").val(d.find(".aimed_collection_mark").domdata("id"));
d.find(".send-tsina-ipter").val("")}c=d.find(".collections-ipter").val().split(",");b.find(".field.collections .c").each(function(){var g=jQuery(this);a(g,false)});jQuery.each(c,function(g,h){var l=b.find(".field.collections .c[data-id="+h+"]");a(l,true)});b.find(".field.collections .c").bind("click",function(){var g=jQuery(this);g.hasClass("checked")?a(g,false):a(g,true);ids=[];b.find(".field.collections .c.checked").each(function(){ids.push(jQuery(this).domdata("id"))});d.find(".collections-ipter").val(ids.join(","))});
b.find(".field.send-to-tsina .c").bind("click",function(){var g=jQuery(this);if(g.hasClass("checked")){a(g,false);d.find(".send-tsina-ipter").val("")}else{a(g,true);d.find(".send-tsina-ipter").val(true)}});d.find(".create-submit").bind("click",function(){var g=true,h=[],l=false;d.find(".field .at-least").each(function(){var n=jQuery(this);l=l||!jQuery.string(n.val()).blank()});if(l==false){g=false;h.push("\u4e0d\u8981\u521b\u5efa\u7a7a\u4e3b\u9898")}var j=d.find(".collections-ipter");if(jQuery.string(j.val()).blank()){g=
false;h.push("\u8bf7\u9009\u62e9\u53d1\u9001\u8303\u56f4")}g?d.submit():d.find(".submit-info").stop().css("opacity",1).html(h.join("\uff1b")).show().fadeOut(1E4)});d.find(".create-save-draft").bind("click",function(){var g=d.serialize();jQuery.ajax({url:"/post_drafts",type:"POST",data:g,success:function(){}})})}});pie.load(function(){var a=jQuery(".page-olist.tasks");a[0]&&a.find(".task .ops .delete").live("click",function(){var d=jQuery(this),b=d.closest(".task");d.confirm_dialog("\u786e\u5b9a\u5220\u9664\u5417",function(){var c=b.domdata("id");jQuery.ajax({url:"/tasks/"+c,type:"delete",success:function(){b.css("overflow","hidden").animate({height:0,opacity:0},200,function(){b.remove()})}})})})});pie.load(function(){var a=jQuery(".field.sendto-select-widget .sendto-selector"),d=jQuery(".field.sendto-select-widget .sendtos"),b=jQuery(".field.sendto-select-widget .sendto-hid"),c=jQuery(".field.sendto-select-widget .sendto-ipter .add");if(a.length>0&&d.length>0&&b.length>0){c.live("click",function(){var g=jQuery(this).closest(".sendto-ipter"),h=g.offset();g=g.outerHeight();a.css("left",h.left).css("top",h.top+g-1).fadeIn(200)});jQuery(document).bind("click.sendto_selector",function(g){g=g.target;
a[0]==g||jQuery.contains(a[0],g)||jQuery.contains(c[0],g)||c[0]==g||a.hide()});var f=function(){var g=[];d.find(".ch").each(function(){var h=jQuery(this);h.hasClass("all-public")&&g.push("public");h.hasClass("all-followings")&&g.push("followings");h.hasClass("a-ch")&&g.push("ch-"+h.attr("data-id"))});g=g.join(",");b.val(g)};f();jQuery(".field.sendto-select-widget .sendtos .ch.all-public").tipsy({gravity:"s",fallback:'<div class="bold">\u5b8c\u5168\u516c\u5f00</div><div>\u516c\u5f00\u5730\u53d1\u9001\u7ed9\u5173\u6ce8\u4f60\u7684\u6240\u6709\u4eba</div>',
html:true,live:true});jQuery(".field.sendto-select-widget .sendtos .ch.all-followings").tipsy({gravity:"s",fallback:'<div class="bold">\u6240\u6709\u8054\u7cfb\u4eba</div><div>\u53d1\u9001\u7ed9\u4f60\u5173\u6ce8\u7684\u6240\u6709\u4eba\uff08\u4f60\u7684\u8054\u7cfb\u4eba\uff09</div>',html:true,live:true});jQuery(".field.sendto-select-widget .sendtos .ch.a-ch").tipsy({gravity:"s",title:function(){var g=jQuery(this);return'<div class="bold">'+jQuery(g.find("span")[1]).html()+"</div><div>\u53d1\u9001\u7ed9\u8fd9\u4e2a\u9891\u9053\u4e2d\u7684\u8054\u7cfb\u4eba</div>"},
html:true,live:true});jQuery(document).delegate(".field.sendto-select-widget .groups .all-public","click",function(){var g=jQuery(this);if(!g.hasClass("lock")){var h=jQuery("<div class='ch all-public'><span class='icon'></span><span>\u5b8c\u5168\u516c\u5f00</span><span class='close'>x</span></div>");a.hide();if(!(d.find(".ch.all-public").length>0)){d.find(".ch").remove();a.find(".it").removeClass("lock");g.addClass("lock");d.append(h);f()}}});jQuery(document).delegate(".field.sendto-select-widget .groups .all-followings",
"click",function(){var g=jQuery(this);if(!g.hasClass("lock")){var h=jQuery("<div class='ch all-followings'><span class='icon'></span><span>\u6240\u6709\u8054\u7cfb\u4eba</span><span class='close'>x</span></div>");a.hide();if(!(d.find(".ch.all-followings").length>0)){d.find(".ch").remove();a.find(".it").removeClass("lock");g.addClass("lock");d.append(h);f()}}});jQuery(document).delegate(".field.sendto-select-widget .channels .ch","click",function(){var g=jQuery(this);if(!g.hasClass("lock")){var h=
g.attr("data-id"),l=g.attr("data-name");str="<div class='ch a-ch' data-id='"+h+"'><span class='icon'></span><span>"+l+"</span><span class='close'>x</span></div>";l=jQuery(str);a.hide();if(!(d.find(".ch.a-ch[data-id="+h+"]").length>0)){d.find(".ch.all-public, .ch.all-followings").remove();a.find(".groups .it").removeClass("lock");g.addClass("lock");d.append(l);f()}}});jQuery(document).delegate(".field.sendto-select-widget .sendtos .ch .close","click",function(){var g=jQuery(this).closest(".ch");g.remove();
g.hasClass("all-public")&&a.find(".groups .all-public").removeClass("lock");g.hasClass("all-followings")&&a.find(".groups .all-followings").removeClass("lock");if(g.hasClass("a-ch")){g=g.attr("data-id");a.find(".ch[data-id="+g+"]").removeClass("lock")}jQuery(".tipsy").remove();f()})}});
