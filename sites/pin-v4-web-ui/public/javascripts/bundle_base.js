pie={html:{},dom:{},data:{},js:{},util:{}};try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}pie.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>=1};pie.isFF=function(){return window.navigator.userAgent.indexOf("Firefox")>=1};pie.isChrome=function(){return window.navigator.userAgent.indexOf("Chrome")>=1};
pie.randstr=function(a){a=a||8;var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toArray(),c=b.length,d=pie.rand(c-10);re=b[d];for(var h=1;h<a;h++){d=pie.rand(c);re+=b[d]}return re};pie.rand=function(a){return Math.round(Math.random()*(a-1))};
Element.addMethods({makeUnselectable:function(a,b){b=b||"default";a.onselectstart=function(){return false};a.unselectable="on";a.style.MozUserSelect="none";return a},makeSelectable:function(a){a.onselectstart=function(){return true};a.unselectable="off";a.style.MozUserSelect="";return a},do_click:function(a){pie.do_click(a)}});
Date.prototype.getFormatValue=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a))a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var c in b)if(RegExp("("+c+")").test(a))a=a.replace(RegExp.$1,RegExp.$1.length==1?b[c]:("00"+b[c]).substr((""+b[c]).length));return a};
pie.do_click=function(a,b){var c=$(a);if(document.createEvent){var d=document.createEvent("MouseEvents");d.initEvent("click",true,false);c.dispatchEvent(d)}else document.createEventObject&&c.fireEvent("onclick");b&&b.stop()};
pie.dom.xml={getXMLDoc:function(){var a=null;if(document.implementation&&document.implementation.createDocument)a=document.implementation.createDocument("","",null);else if(typeof ActiveXObject!="undefined")a=new ActiveXObject("MSXML2.DOMDocument");a.async=false;return a},getXMLDocFromString:function(a){var b=null;if(document.implementation&&document.implementation.createDocument){var c=new DOMParser;b=c.parseFromString(a,"text/xml");delete c}else if(typeof ActiveXObject!="undefined"){b=new ActiveXObject("MSXML2.DOMDocument");
b.loadXML(a)}return b},transformXML:function(a,b){if(window.ActiveXObject)return a.documentElement.transformNode(b);else{var c=new XSLTProcessor;c.importStylesheet(b);c=c.transformToFragment(a,document);var d=document.createElement("div");d.appendChild(c);return d.innerHTML}},serialize:function(a){var b=a.xml;if(b==undefined)try{var c=new XMLSerializer;b=c.serializeToString(a);delete c}catch(d){debug&&alert("DOM serialization is not supported.")}return b}};
pie.log=function(){var a=[];for(i=0;i<arguments.length;i++)a.push("arguments["+i+"]");eval("try{console.log("+a.join(",")+")}catch(e){}")};pie.dir=function(){var a=[];for(i=0;i<arguments.length;i++)a.push("arguments["+i+"]");eval("try{console.dir("+a.join(",")+")}catch(e){}")};pie.open_win=function(a){window.open(a,"connect_window","height=420, width=520, toolbar =no, menubar=no, scrollbars=yes, resizable=no,top="+(document.body.clientHeight-420)/2+",left="+(document.body.clientWidth-520)/2+", location=no, status=no")};
pie.load=function(a){document.observe("dom:loaded",function(){try{a()}catch(b){alert(b)}})};
if(pie.isFF()){HTMLElement.prototype.contains=function(a){do if(a==this)return true;while(a=a.parentNode);return false};HTMLElement.prototype.__defineGetter__("outerHTML",function(){for(var a,b=this.attributes,c="<"+this.tagName,d=0;d<b.length;d++){a=b[d];if(a.specified)c+=" "+a.name+'="'+a.value+'"'}if(!this.canHaveChildren)return c+">";return c+">"+this.innerHTML+"</"+this.tagName+">"});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())});
Event.prototype.__defineGetter__("fromElement",function(){var a;if(this.type=="mouseover")a=this.relatedTarget;else if(this.type=="mouseout")a=this.target;if(!a)return null;for(;a.nodeType!=1;)a=a.parentNode;return a});Event.prototype.__defineGetter__("toElement",function(){try{var a;if(this.type=="mouseout")a=this.relatedTarget;else if(this.type=="mouseover")a=this.target;if(!a||a.tagName=="INPUT"&&a.type=="file")return null;for(;a.nodeType!=1;)a=a.parentNode;return a}catch(b){}})}
MINDPIN_URLS={production:{user_auth:"http://www.mindpin.com/","pin-user-auth":"http://www.mindpin.com/",discuss:"http://discuss.mindpin.com/","pin-discuss":"http://discuss.mindpin.com/","pin-workspace":"http://workspace.mindpin.com/",ui:"http://ui.mindpin.com/","pin-bugs":"http://bugs.mindpin.com/","pin-app-adapter":"http://app-adapter.mindpin.com/","pin-share":"http://share.mindpin.com/","pin-mindmap-editor":"http://mindmap-editor.mindpin.com/","pin-mindmap-image-cache":"http://mindmap-image-cache.mindpin.com/",
"pin-macro":"http://macro.mindpin.com/","pin-website":"http://website.mindpin.com/","pin-notes":"http://notes.mindpin.com/","pin-mev6":"http://mev6.mindpin.com/"},development:{user_auth:"http://dev.www.mindpin.com/","pin-user-auth":"http://dev.www.mindpin.com/",discuss:"http://dev.discuss.mindpin.com/","pin-discuss":"http://dev.discuss.mindpin.com/","pin-workspace":"http://dev.workspace.mindpin.com/",ui:"http://dev.ui.mindpin.com/","pin-bugs":"http://dev.bugs.mindpin.com/","pin-app-adapter":"http://dev.app-adapter.mindpin.com/",
"pin-share":"http://dev.share.mindpin.com/","pin-mindmap-editor":"http://dev.mindmap-editor.mindpin.com/","pin-mindmap-image-cache":"http://dev.mindmap-image-cache.mindpin.com/","pin-macro":"http://dev.macro.mindpin.com/","pin-website":"http://dev.website.mindpin.com/","pin-notes":"http://dev.notes.mindpin.com/","pin-mev6":"http://dev.mev6.mindpin.com/"}};pie.pin_url_for=function(a,b){var c=MINDPIN_URLS[pie.env][a];b=b||"";if(b.blank())return c;return c+b.gsub(/^\//,"")};(function(a){function b(){a('html body input[type="text"], html body input[type="password"]').addClass("text");a('input[type="submit"]').addClass("submit");a('input[type="checkbox"]').addClass("checkbox");a("form .fieldWithErrors").closest("div.field").addClass("error");a("form .fieldWithErrors input, form .fieldWithErrors textarea").each(function(c,d){width=a(d).width();a(d).closest("div.field").find(".formError").width(width)})}jQuery(document).ready(b);jQuery(document).bind("reveal.facebox",b)})(jQuery);
(function(a){jQuery(document).ready(function(){a("form select, form .text, form textarea").live("focus",function(){a(this).closest("div.field").addClass("active");a(this).closest("fieldset").addClass("active")}).live("blur",function(){a(this).closest("div.field").removeClass("active");a(this).closest("fieldset").removeClass("active")});a("input[type='submit'],a.button").live("mousedown",function(){a(this).addClass("mousedown")}).live("mouseup mouseleave",function(){a(this).removeClass("mousedown")})})})(jQuery);(function(a){jQuery(document).ready(function(){a("button, .minibutton").live("mousedown",function(){a(this).addClass("mousedown")}).live("mouseup mouseleave",function(){a(this).removeClass("mousedown")})})})(jQuery);var MpAccordion=Class.create({initialize:function(a,b,c){this.elements=$A(b);this.togglers=$A(a);this.setOptions(c);this.togglers.each(function(d,h){d.prevClick=d.onclick?d.onclick:function(){};$(d).onclick=function(){d.prevClick();this.show_or_hide(h)}.bind(this)}.bind(this))},setOptions:function(a){this.options=a||{};this.options=Object.extend({unfold_bgc:"#ff0000"},this.options)},show_or_hide:function(a){var b=this.elements[a];if(b.offsetHeight==b.scrollHeight)this.hide_el(a);else b.offsetHeight==
0&&this.show_el(a)},show_el:function(a){var b=this.elements[a];a=this.togglers[a];this.change_el_height(b,b.scrollHeight);b=a.getAttribute("data-active-bgc");this.change_title_color(a,b);a.addClassName("open").removeClassName("close")},hide_el:function(a){var b=this.togglers[a];this.change_el_height(this.elements[a],0);this.change_title_color(b,b.getAttribute("data-bgc"));b.removeClassName("open").addClassName("close")},change_title_color:function(a,b){b!=null&&new Effect.Morph(a,{style:{backgroundColor:b},
duration:0.1})},change_el_height:function(a,b){new Effect.Morph(a,{style:{height:b+"px"},duration:0.3})}});pie.load(function(){$$(".mpaccordion-bar").each(function(a){var b=a.select(".mpaccordion-toggler");a=a.select(".mpaccordion-content");new MpAccordion(b,a,{})}.bind(this))});pie.mplist={init:function(){this.editing=this.over=this.selected=null;this._enabled_el_ids=[];document.observe("mplist:loaded",function(){this.init_mplist_mouse_over_and_out_effects_and_click_select()}.bind(this));document.observe("mplist:select",function(a){mplist_select_handler(a)});this.loaded()},loaded:function(){document.fire("mplist:loaded")},clear_paper_events_cache:function(){$$("#mppaper .mplist").each(function(a){this._enabled_el_ids=this._enabled_el_ids.without(a.id)}.bind(this))},init_mplist_mouse_over_and_out_effects_and_click_select:function(){$$(".mplist.mouseoverable").each(function(a){if(!this._enabled_el_ids.include(a)){this._init_mouseover(a);
this._init_mouseout(a);this._init_click_select(a);this._enabled_el_ids.push(a)}}.bind(this))},_init_mouseover:function(a){$(a).observe("mouseover",function(b){if(b=$(b.toElement))if(b=this._is_in_li(b,a)){this.over&&this.over.removeClassName("mouseover");this.over=b;b.addClassName("mouseover")}}.bind(this))},_init_mouseout:function(a){$(a).observe("mouseout",function(b){var c=$(b.fromElement);b=$(b.toElement);if(!b||$(c).ancestors().include(b))(c=this._is_in_li(c,a))&&c.removeClassName("mouseover")}.bind(this))},
_init_click_select:function(a){$(a).observe("click",function(b){(b=this._is_in_li(b.element(),a))&&this._do_select_mplist_li(b)}.bind(this))},_is_in_li:function(a,b){if(a.tagName=="LI"&&a.parentNode==b)return a;var c=$(a).up("li");if(c&&$(a).up("ul")==b)return c;return false},_get_mpli:function(a){if(a.tagName=="LI"&&a.parentNode.tagName=="UL")return a;var b=$(a).up("li");if(b&&$(a).up("ul"))return b;return false},_do_select_mplist_li:function(a){if(!$(a).hasClassName("mouseselected")){this._do_mp_select_mplist_li_change_class_name(a);
a.fire("mplist:select")}},_do_mp_select_mplist_li_change_class_name:function(a){this.selected&&$(this.selected).removeClassName("mouseselected");this.selected=a;$(a).addClassName("mouseselected")},open_new_form:function(a,b,c){var d=$(Builder.node("li",{id:"li_new","class":"editing_form"}));d.update(a);c?$(c).insert({after:d}):$(b).insert(d)},open_edit_form:function(a,b){var c=$(a);c.addClassName("editing");var d=$(Builder.node("li",{id:"li_edit_"+c.id,"class":"editing_form"}));d.update(b);c.insert({after:d});
this.editing_li=c},close_edit_form:function(){$$("#li_new").each(function(a){$(a).remove()});if(this.editing_li){$("li_edit_"+this.editing_li.id).remove();$(this.editing_li).removeClassName("editing");this.editing_li=null}},close_all_new_form:function(a){a?$(a).select("#li_new").each(function(b){$(b).remove()}):$$("#li_new").each(function(b){$(b).remove()})},insert_li:function(a,b,c){var d=Builder.node("div").update(b).firstChild;if(c)c=="TOP"?$(a).insert({top:d}):$$(c).each(function(h){h.insert({after:d})});
else $(a).insert(d);$(d).highlight({duration:0.3,afterFinish:function(){pie.mplist.clear_background(d)}})},remove_li:function(a){var b=$(a);$(b).fade({duration:0.3});$(b).highlight({startcolor:"#FFECCB",duration:0.3,afterFinish:function(){pie.mplist.clear_background(b)}});setTimeout(function(){$(b);$(b).remove()}.bind(this),300)},update_li:function(a,b){this.close_edit_form();$(a).update(b);$(a).highlight({duration:0.3,afterFinish:function(){pie.mplist.clear_background(a)}})},clear_background:function(a){a.setStyle({backgroundImage:"",
backgroundColor:""})},deal_app_json:function(a,b,c){try{var d=a.evalJSON(),h=d.html,o=b+"_"+d.id;$$("#"+c).each(function(p){p.down("#"+o)?this.update_li($(o),h):this.insert_li(p,'<li id="'+o+'">'+h+"</li>","TOP")}.bind(this))}catch(q){alert(q)}}};(function(a){jQuery(document).ready(function(){a(".mplist li:even").addClass("even");pie.mplist.init()})})(jQuery);(function(a){a(document).ready(function(){a("[original-title]").tipsy({html:true});a("[tip]").tipsy({html:true,title:function(){var b=this.getAttribute("tip"),c=a(b);if(c.length==0)return b;return c.html()}});a("[tipr]").tipsy({html:true,gravity:"w",title:function(){var b=this.getAttribute("tipr"),c=a(b);if(c.length==0)return b;return c.html()}})})})(jQuery);(function(){function a(b){pie.TextareaAdaptHeight.Executer=new PeriodicalExecuter(function(){b.fire("dom:value_change")},0.01)}pie.TextareaAdaptHeight=function(b){var c=1,d=b.readAttribute("rel").match(/adapt\[(.*)\]/);if(d)c=d[1];c=c*18;b.defaultHeight=c;b.setStyle({lineHeight:"18px",height:c+"px"});b.observe("dom:value_change",function(){var h;h=$("virtual_textarea");if(!h){h=Builder.node("textarea",{id:"virtual_textarea"});$(document.body).insert(h)}h=h;h.value=b.value;b.setStyle({height:Math.max(h.scrollHeight,
b.defaultHeight)+"px"})});$(b).observe("focus",function(){pie.TextareaAdaptHeight.Executer&&pie.TextareaAdaptHeight.Executer.stop();a(b)});$(b).observe("blur",function(){pie.TextareaAdaptHeight.Executer&&pie.TextareaAdaptHeight.Executer.stop()});b.value=""}})();pie.TextareaAdaptHeight.init=function(){$$("textarea[rel*=adapt]").each(function(a){if(!a.hasClassName("adapt-packed")){a.addClassName("adapt-packed");pie.TextareaAdaptHeight(a)}})};pie.load(function(){pie.TextareaAdaptHeight.init()});(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(h){return h};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},
setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(b,c){function d(){var j=u.selected();if(!j)return false;var s=j.result;t=s;if(c.multiple){var x=o(g.val());if(x.length>1){var w=c.multipleSeparator.length,C=a(b).selection().start,z,A=0;a.each(x,function(E,D){A+=D.length;if(C<=A){z=E;return false}A+=w});x[z]=s;s=x.join(c.multipleSeparator)}s+=c.multipleSeparator}g.val(s);p();g.trigger("result",[j.data,
j.value]);return true}function h(j,s){if(r==l.DEL)u.hide();else{var x=g.val();if(!(!s&&x==t)){t=x;x=q(x);if(x.length>=c.minChars){g.addClass(c.loadingClass);c.matchCase||(x=x.toLowerCase());n(x,k,p)}else{g.removeClass(c.loadingClass);u.hide()}}}}function o(j){if(!j)return[""];if(!c.multiple)return[a.trim(j)];return a.map(j.split(c.multipleSeparator),function(s){return a.trim(j).length?a.trim(s):null})}function q(j){if(!c.multiple)return j;var s=o(j);if(s.length==1)return s[0];s=a(b).selection().start;
s=s==j.length?o(j):o(j.replace(j.substring(s),""));return s[s.length-1]}function p(){u.visible();u.hide();clearTimeout(m);g.removeClass(c.loadingClass);c.mustMatch&&g.search(function(j){if(!j)if(c.multiple){j=o(g.val()).slice(0,-1);g.val(j.join(c.multipleSeparator)+(j.length?c.multipleSeparator:""))}else{g.val("");g.trigger("result",null)}})}function k(j,s){if(s&&s.length&&f){g.removeClass(c.loadingClass);u.display(s,j);var x=s[0].value;if(c.autoFill&&q(g.val()).toLowerCase()==j.toLowerCase()&&r!=
l.BACKSPACE){g.val(g.val()+x.substring(q(t).length));a(b).selection(t.length,t.length+x.length)}u.show()}else p()}function n(j,s,x){c.matchCase||(j=j.toLowerCase());var w=y.load(j);if(w&&w.length)s(j,w);else if(typeof c.url=="string"&&c.url.length>0){var C={timestamp:+new Date};a.each(c.extraParams,function(z,A){C[z]=typeof A=="function"?A():A});a.ajax({mode:"abort",port:"autocomplete"+b.name,dataType:c.dataType,url:c.url,data:a.extend({q:q(j),limit:c.max},C),success:function(z){var A;if(!(A=c.parse&&
c.parse(z))){A=[];z=z.split("\n");for(var E=0;E<z.length;E++){var D=a.trim(z[E]);if(D){D=D.split("|");A[A.length]={data:D,value:D[0],result:c.formatResult&&c.formatResult(D,D[0])||D[0]}}}A=A}A=A;y.add(j,A);s(j,A)}})}else{u.emptyList();x(j)}}var l={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},g=a(b).attr("autocomplete","off").addClass(c.inputClass),m,t="",y=a.Autocompleter.Cache(c),f=0,r,B={mouseDownOnSelect:false},u=a.Autocompleter.Select(c,b,d,B),v;a.browser.opera&&
a(b.form).bind("submit.autocomplete",function(){if(v)return v=false});g.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(j){f=1;r=j.keyCode;switch(j.keyCode){case l.UP:j.preventDefault();u.visible()?u.prev():h(0,true);break;case l.DOWN:j.preventDefault();u.visible()?u.next():h(0,true);break;case l.PAGEUP:j.preventDefault();u.visible()?u.pageUp():h(0,true);break;case l.PAGEDOWN:j.preventDefault();u.visible()?u.pageDown():h(0,true);break;case c.multiple&&a.trim(c.multipleSeparator)==
","&&l.COMMA:case l.TAB:case l.RETURN:if(d()){j.preventDefault();v=true;return false}break;case l.ESC:u.hide();break;default:clearTimeout(m);m=setTimeout(h,c.delay);break}}).focus(function(){f++}).blur(function(){f=0;if(!B.mouseDownOnSelect){clearTimeout(m);m=setTimeout(p,200)}}).click(function(){f++>1&&!u.visible()&&h(0,true)}).bind("search",function(){function j(x,w){var C;if(w&&w.length)for(var z=0;z<w.length;z++)if(w[z].result.toLowerCase()==x.toLowerCase()){C=w[z];break}typeof s=="function"?
s(C):g.trigger("result",C&&[C.data,C.value])}var s=arguments.length>1?arguments[1]:null;a.each(o(g.val()),function(x,w){n(w,j,j)})}).bind("flushCache",function(){y.flush()}).bind("setOptions",function(j,s){a.extend(c,s);"data"in s&&y.populate()}).bind("unautocomplete",function(){u.unbind();g.unbind();a(b.form).unbind(".autocomplete")}).bind("input",function(){h(0,true)})};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,
matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(b,c){return b.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+c.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(b){function c(k,n){b.matchCase||(k=
k.toLowerCase());var l=k.indexOf(n);if(b.matchContains=="word")l=k.toLowerCase().search("\\b"+n.toLowerCase());if(l==-1)return false;return l==0||b.matchContains}function d(k,n){p>b.cacheLength&&o();q[k]||p++;q[k]=n}function h(){if(!b.data)return false;var k={},n=0;if(!b.url)b.cacheLength=1;k[""]=[];for(var l=0,g=b.data.length;l<g;l++){var m=b.data[l];m=typeof m=="string"?[m]:m;var t=b.formatMatch(m,l+1,b.data.length);if(t!==false){var y=t.charAt(0).toLowerCase();k[y]||(k[y]=[]);m={value:t,data:m,
result:b.formatResult&&b.formatResult(m)||t};k[y].push(m);n++<b.max&&k[""].push(m)}}a.each(k,function(f,r){b.cacheLength++;d(f,r)})}function o(){q={};p=0}var q={},p=0;setTimeout(h,25);return{flush:o,add:d,populate:h,load:function(k){if(!b.cacheLength||!p)return null;if(!b.url&&b.matchContains){var n=[];for(var l in q)if(l.length>0){var g=q[l];a.each(g,function(m,t){c(t.value,k)&&n.push(t)})}return n}else if(q[k])return q[k];else if(b.matchSubset)for(l=k.length-1;l>=b.minChars;l--)if(g=q[k.substr(0,
l)]){n=[];a.each(g,function(m,t){if(c(t.value,k))n[n.length]=t});return n}return null}}};a.Autocompleter.Select=function(b,c,d,h){function o(){if(t){y=a("<div/>").hide().addClass(b.resultsClass).css("position","absolute").appendTo(document.body);f=a("<ul/>").appendTo(y).mouseover(function(r){if(q(r).nodeName&&q(r).nodeName.toUpperCase()=="LI"){l=a("li",f).removeClass(k.ACTIVE).index(q(r));a(q(r)).addClass(k.ACTIVE)}}).click(function(r){a(q(r)).addClass(k.ACTIVE);d();c.focus();return false}).mousedown(function(){h.mouseDownOnSelect=
true}).mouseup(function(){h.mouseDownOnSelect=false});b.width>0&&y.css("width",b.width);t=false}}function q(r){for(r=r.target;r&&r.tagName!="LI";)r=r.parentNode;if(!r)return[];return r}function p(r){n.slice(l,l+1).removeClass(k.ACTIVE);l+=r;if(l<0)l=n.size()-1;else if(l>=n.size())l=0;r=n.slice(l,l+1).addClass(k.ACTIVE);if(b.scroll){var B=0;n.slice(0,l).each(function(){B+=this.offsetHeight});if(B+r[0].offsetHeight-f.scrollTop()>f[0].clientHeight)f.scrollTop(B+r[0].offsetHeight-f.innerHeight());else B<
f.scrollTop()&&f.scrollTop(B)}}var k={ACTIVE:"ac_over"},n,l=-1,g,m="",t=true,y,f;return{display:function(r,B){o();g=r;m=B;f.empty();for(var u=b.max&&b.max<g.length?b.max:g.length,v=0;v<u;v++)if(g[v]){var j=b.formatItem(g[v].data,v+1,u,g[v].value,m);if(j!==false){j=a("<li/>").html(b.highlight(j,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(f)[0];a.data(j,"ac_data",g[v])}}n=f.find("li");if(b.selectFirst){n.slice(0,1).addClass(k.ACTIVE);l=0}a.fn.bgiframe&&f.bgiframe()},next:function(){p(1)},prev:function(){p(-1)},
pageUp:function(){l!=0&&l-8<0?p(-l):p(-8)},pageDown:function(){l!=n.size()-1&&l+8>n.size()?p(n.size()-1-l):p(8)},hide:function(){y&&y.hide();n&&n.removeClass(k.ACTIVE);l=-1},visible:function(){return y&&y.is(":visible")},current:function(){return this.visible()&&(n.filter("."+k.ACTIVE)[0]||b.selectFirst&&n[0])},show:function(){var r=a(c).offset();y.css({width:typeof b.width=="string"||b.width>0?b.width:a(c).width(),top:r.top+c.offsetHeight,left:r.left}).show();if(b.scroll){f.scrollTop(0);f.css({maxHeight:b.scrollHeight,
overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var B=0;n.each(function(){B+=this.offsetHeight});r=B>b.scrollHeight;f.css("height",r?b.scrollHeight:B);r||n.width(f.width()-parseInt(n.css("padding-left"))-parseInt(n.css("padding-right")))}}},selected:function(){var r=n&&n.filter("."+k.ACTIVE).removeClass(k.ACTIVE);return r&&r.length&&a.data(r[0],"ac_data")},emptyList:function(){f&&f.empty()},unbind:function(){y&&y.remove()}}};a.fn.selection=function(b,c){if(b!==
undefined)return this.each(function(){if(this.createTextRange){var p=this.createTextRange();if(c===undefined||b==c)p.move("character",b);else{p.collapse(true);p.moveStart("character",b);p.moveEnd("character",c)}p.select()}else if(this.setSelectionRange)this.setSelectionRange(b,c);else if(this.selectionStart){this.selectionStart=b;this.selectionEnd=c}});var d=this[0];if(d.createTextRange){var h=document.selection.createRange(),o=d.value,q=h.text.length;h.text="<->";h=d.value.indexOf("<->");d.value=
o;this.selection(h,h+q);return{start:h,end:h+q}}else if(d.selectionStart!==undefined)return{start:d.selectionStart,end:d.selectionEnd}}})(jQuery);jQuery.cookie=function(a,b,c){if(arguments.length>1&&String(b)!=="[object Object]"){c=jQuery.extend({},c);if(b===null||b===undefined)c.expires=-1;if(typeof c.expires==="number"){var d=c.expires,h=c.expires=new Date;h.setDate(h.getDate()+d)}b=String(b);return document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};h=c.raw?function(o){return o}:
decodeURIComponent;return(d=RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?h(d[1]):null};(function(a){function b(g){if(a.facebox.settings.inited)return true;else a.facebox.settings.inited=true;a(document).trigger("init.facebox");h();var m=a.facebox.settings.imageTypes.join("|");a.facebox.settings.imageTypesRegexp=RegExp("."+m+"$","i");g&&a.extend(a.facebox.settings,g);a("body").append(a.facebox.settings.faceboxHtml);var t=[new Image,new Image];a("#facebox").find(".b:first, .bl, .br, .tl, .tr").each(function(){t.push(new Image);t.slice(-1).src=a(this).css("background-image").replace(/url\((.+)\)/,
"$1")});a("#facebox .close").click(a.facebox.close)}function c(){var g,m;if(self.pageYOffset){m=self.pageYOffset;g=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){m=document.documentElement.scrollTop;g=document.documentElement.scrollLeft}else if(document.body){m=document.body.scrollTop;g=document.body.scrollLeft}return Array(g,m)}function d(){var g;if(self.innerHeight)g=self.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)g=
document.documentElement.clientHeight;else if(document.body)g=document.body.clientHeight;return g}function h(){var g=a.facebox.settings;g.imageTypes=g.image_types||g.imageTypes;g.faceboxHtml=g.facebox_html||g.faceboxHtml}function o(g,m){if(g.match(/#/)){var t=window.location.href.split("#")[0];t=g.replace(t,"");a.facebox.reveal(a(t).clone().show(),m)}else g.match(a.facebox.settings.imageTypesRegexp)?q(g,m):p(g,m)}function q(g,m){var t=new Image;t.onload=function(){a.facebox.reveal('<div class="image"><img src="'+
t.src+'" /></div>',m)};t.src=g}function p(g,m){a.get(g,function(t){a.facebox.reveal(t,m)})}function k(){return a.facebox.settings.overlay==false||a.facebox.settings.opacity===null}function n(){if(!k()){a("facebox_overlay").length==0&&a("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');a("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",a.facebox.settings.opacity).click(function(){a(document).trigger("close.facebox")}).fadeIn(200);return false}}function l(){if(!k()){a("#facebox_overlay").fadeOut(200,
function(){a("#facebox_overlay").removeClass("facebox_overlayBG");a("#facebox_overlay").addClass("facebox_hide");a("#facebox_overlay").remove()});return false}}a.facebox=function(g,m){a.facebox.loading();if(g.ajax)p(g.ajax);else if(g.image)q(g.image);else if(g.div)o(g.div);else a.isFunction(g)?g.call(a):a.facebox.reveal(g,m)};a.extend(a.facebox,{settings:{opacity:0.4,overlay:true,imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="javascript:;" class="close"></a>       </div>     </div>'},
loading:function(){b();if(a("#facebox .loading").length==1)return true;n();a("#facebox .content").empty();a("#facebox .body").children().hide().end().append('<div class="loading"></div>');a("#facebox").css({top:c()[1]+d()/10,left:385.5}).show();a(document).bind("keydown.facebox",function(g){g.keyCode==27&&a.facebox.close();return true});a(document).trigger("loading.facebox")},reveal:function(g,m){a(document).trigger("beforeReveal.facebox");m&&a("#facebox .content").addClass(m);a("#facebox .content").append(g);
a("#facebox .loading").remove();a("#facebox .body").children().fadeIn("normal");a("#facebox").css("left",a(window).width()/2-a("#facebox").width()/2);a(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){a(document).trigger("close.facebox");return false}});a.fn.facebox=function(g){b(g);return this.click(function(){a.facebox.loading(true);var m=this.rel.match(/facebox\[?\.(\w+)\]?/);if(m)m=m[1];o(this.href,m);return false})};a(document).bind("close.facebox",function(){a(document).unbind("keydown.facebox");
a("#facebox").fadeOut(function(){a("#facebox .content").removeClass().addClass("content");l();a("#facebox .loading").remove()})})})(jQuery);jQuery(document).ready(function(a){a("a[rel*=facebox]").facebox()});function show_fbox(a){if(jQuery("#facebox").length==0||jQuery("#facebox").css("display")=="none"){jQuery.facebox(a);jQuery("#facebox_overlay").unbind("click")}else{jQuery("#facebox .content").empty();jQuery.facebox.reveal(a)}}function close_fbox(){jQuery(document).trigger("close.facebox")};(function(){function a(b){var c=new Date,d=c.valueOf(),h=b.valueOf();d=d-h;if(d<6E4)return parseInt(d/1E3)+"\u79d2\u524d";if(d<36E5)return parseInt(d/6E4)+"\u5206\u949f\u524d";if(d<864E5&&b.getDate()==c.getDate())return"\u4eca\u5929 "+b.getHours()+"\u70b9"+b.getMinutes()+"\u5206";if(b.getYear()==c.getYear())return b.getMonth()+1+"\u6708"+b.getDate()+"\u65e5 "+b.getHours()+"\u70b9"+b.getMinutes()+"\u5206";return b.getFullYear()+"\u5e74 "+(b.getMonth()+1)+"\u6708"+b.getDate()+"\u65e5 "+b.getHours()+
"\u70b9"+b.getMinutes()+"\u5206"}jQuery.fn.extend({refresh_time:function(){this.each(function(){var b=jQuery(this),c=b.attr("data-date");if(c){var d=new Date;d.setTime(c*1E3);c=a(d);b.text(c)}})}});jQuery(document).ready(function(){setInterval(function(){jQuery("span[data-date]").refresh_time()},3E4)})})();(function(a){a.fn.editable=function(b,c){if("disable"==b)a(this).data("disabled.editable",true);else if("enable"==b)a(this).data("disabled.editable",false);else if("destroy"==b)a(this).unbind(a(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");else{var d=a.extend({},a.fn.editable.defaults,{target:b},c),h=a.editable.types[d.type].plugin||function(){},o=a.editable.types[d.type].submit||function(){},q=a.editable.types[d.type].buttons||a.editable.types.defaults.buttons,
p=a.editable.types[d.type].content||a.editable.types.defaults.content,k=a.editable.types[d.type].element||a.editable.types.defaults.element,n=a.editable.types[d.type].reset||a.editable.types.defaults.reset,l=d.callback||function(){},g=d.onedit||function(){},m=d.onsubmit||function(){},t=d.onreset||function(){},y=d.onerror||n;d.tooltip&&a(this).attr("title",d.tooltip);d.autowidth="auto"==d.width;d.autoheight="auto"==d.height;return this.each(function(){var f=this,r=a(f).width(),B=a(f).height();a(this).data("event.editable",
d.event);a.trim(a(this).html())||a(this).html(d.placeholder);a(this).bind(d.event,function(u){if(true!==a(this).data("disabled.editable"))if(!f.editing)if(false!==g.apply(this,[d,f])){u.preventDefault();u.stopPropagation();d.tooltip&&a(f).removeAttr("title");if(0==a(f).width()){d.width=r;d.height=B}else{if(d.width!="none")d.width=d.autowidth?a(f).width():d.width;if(d.height!="none")d.height=d.autoheight?a(f).height():d.height}a(this).html().toLowerCase().replace(/(;|")/g,"")==d.placeholder.toLowerCase().replace(/(;|")/g,
"")&&a(this).html("");f.editing=true;f.revert=a(f).html();a(f).html("");var v=a("<form />");if(d.cssclass)"inherit"==d.cssclass?v.attr("class",a(f).attr("class")):v.attr("class",d.cssclass);if(d.style)if("inherit"==d.style){v.attr("style",a(f).attr("style"));v.css("display",a(f).css("display"))}else v.attr("style",d.style);var j=k.apply(v,[d,f]),s;if(d.loadurl){var x=setTimeout(function(){j.disabled=true;p.apply(v,[d.loadtext,d,f])},100);u={};u[d.id]=f.id;a.isFunction(d.loaddata)?a.extend(u,d.loaddata.apply(f,
[f.revert,d])):a.extend(u,d.loaddata);a.ajax({type:d.loadtype,url:d.loadurl,data:u,async:false,success:function(w){window.clearTimeout(x);s=w;j.disabled=false}})}else if(d.data){s=d.data;if(a.isFunction(d.data))s=d.data.apply(f,[f.revert,d])}else s=f.revert;p.apply(v,[s,d,f]);j.attr("name",d.name);q.apply(v,[d,f]);a(f).append(v);h.apply(v,[d,f]);a(":input:visible:enabled:first",v).focus();d.select&&j.select();j.keydown(function(w){if(w.keyCode==27){w.preventDefault();n.apply(v,[d,f])}});if("cancel"==
d.onblur)j.blur(function(){x=setTimeout(function(){n.apply(v,[d,f])},500)});else if("submit"==d.onblur)j.blur(function(){x=setTimeout(function(){v.submit()},200)});else a.isFunction(d.onblur)?j.blur(function(){d.onblur.apply(f,[j.val(),d])}):j.blur(function(){});v.submit(function(w){x&&clearTimeout(x);w.preventDefault();if(false!==m.apply(v,[d,f]))if(false!==o.apply(v,[d,f]))if(a.isFunction(d.target)){w=d.target.apply(f,[j.val(),d]);a(f).html(w);f.editing=false;l.apply(f,[f.innerHTML,d]);a.trim(a(f).html())||
a(f).html(d.placeholder)}else{w={};w[d.name]=j.val();w[d.id]=f.id;a.isFunction(d.submitdata)?a.extend(w,d.submitdata.apply(f,[f.revert,d])):a.extend(w,d.submitdata);if("PUT"==d.method)w._method="put";a(f).html(d.indicator);var C={type:"POST",data:w,dataType:"html",url:d.target,success:function(z){C.dataType=="html"&&a(f).html(z);f.editing=false;l.apply(f,[z,d]);a.trim(a(f).html())||a(f).html(d.placeholder)},error:function(z){y.apply(v,[d,f,z])}};a.extend(C,d.ajaxoptions);a.ajax(C)}a(f).attr("title",
d.tooltip);return false})}});this.reset=function(u){if(this.editing)if(false!==t.apply(u,[d,f])){a(f).html(f.revert);f.editing=false;a.trim(a(f).html())||a(f).html(d.placeholder);d.tooltip&&a(f).attr("title",d.tooltip)}}})}};a.editable={types:{defaults:{element:function(){var b=a('<input type="hidden"></input>');a(this).append(b);return b},content:function(b){a(":input:first",this).val(b)},reset:function(b,c){c.reset(this)},buttons:function(b,c){var d=this;if(b.submit){if(b.submit.match(/>$/))var h=
a(b.submit).click(function(){h.attr("type")!="submit"&&d.submit()});else{h=a('<button class="editable-submit" type="submit" />');h.html(b.submit)}a(this).append(h)}if(b.cancel){if(b.cancel.match(/>$/))var o=a(b.cancel);else{o=a('<button class="editable-cancel" type="cancel" />');o.html(b.cancel)}a(this).append(o);a(o).click(function(){(a.isFunction(a.editable.types[b.type].reset)?a.editable.types[b.type].reset:a.editable.types.defaults.reset).apply(d,[b,c]);return false})}}},text:{element:function(b){var c=
a("<input />");b.width!="none"&&c.width(b.width);b.height!="none"&&c.height(b.height);c.attr("autocomplete","off");a(this).append(c);return c}},textarea:{element:function(b){var c=a("<textarea />");if(b.rows)c.attr("rows",b.rows);else b.height!="none"&&c.height(b.height);if(b.cols)c.attr("cols",b.cols);else b.width!="none"&&c.width(b.width);a(this).append(c);return c}},select:{element:function(){var b=a("<select />");a(this).append(b);return b},content:function(b,c,d){if(String==b.constructor)eval("var json = "+
b);else var h=b;for(var o in h)if(h.hasOwnProperty(o))if("selected"!=o){b=a("<option />").val(o).append(h[o]);a("select",this).append(b)}a("select",this).children().each(function(){if(a(this).val()==h.selected||a(this).text()==a.trim(d.revert))a(this).attr("selected","selected")})}}},addInputType:function(b,c){a.editable.types[b]=c}};a.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",
loaddata:{},submitdata:{},ajaxoptions:{}}})(jQuery);(function(a){function b(c,d){this.$element=a(c);this.options=d;this.enabled=true;this.fixTitle()}b.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](c);d[0].className="tipsy";d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);c=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var h=d[0].offsetWidth,o=d[0].offsetHeight,
q=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,p;switch(q.charAt(0)){case "n":p={top:c.top+c.height+this.options.offset,left:c.left+c.width/2-h/2};break;case "s":p={top:c.top-o-this.options.offset,left:c.left+c.width/2-h/2};break;case "e":p={top:c.top+c.height/2-o/2,left:c.left-h-this.options.offset};break;case "w":p={top:c.top+c.height/2-o/2,left:c.left+c.width+this.options.offset};break}if(q.length==2)p.left=q.charAt(1)=="w"?c.left+c.width/
2-15:c.left+c.width/2-h+15;d.css(p).addClass("tipsy-"+q);this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof c.attr("original-title")!="string")c.attr("original-title",c.attr("title")||"").removeAttr("title")},
getTitle:function(){var c,d=this.$element,h=this.options;this.fixTitle();h=this.options;if(typeof h.title=="string")c=d.attr(h.title=="title"?"original-title":h.title);else if(typeof h.title=="function")c=h.title.call(d[0]);return(c=(""+c).replace(/(^\s*|\s*$)/,""))||h.fallback},tip:function(){if(!this.$tip)this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();
this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(c){function d(k){var n=a.data(k,"tipsy");if(!n){n=new b(k,a.fn.tipsy.elementOptions(k,c));a.data(k,"tipsy",n)}return n}function h(){var k=d(this);k.hoverState="in";if(c.delayIn==0)k.show();else{k.fixTitle();setTimeout(function(){k.hoverState=="in"&&k.show()},c.delayIn)}}function o(){var k=d(this);k.hoverState="out";
c.delayOut==0?k.hide():setTimeout(function(){k.hoverState=="out"&&k.hide()},c.delayOut)}if(c===true)return this.data("tipsy");else if(typeof c=="string"){var q=this.data("tipsy");q&&q[c]();return this}c=a.extend({},a.fn.tipsy.defaults,c);c.live||this.each(function(){d(this)});if(c.trigger!="manual"){q=c.live?"live":"bind";var p=c.trigger=="hover"?"mouseleave":"blur";this[q](c.trigger=="hover"?"mouseenter":"focus",h)[q](p,o)}return this};a.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",
gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.elementOptions=function(c,d){return a.metadata?a.extend({},d,a(c).metadata()):d};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"}})(jQuery);
